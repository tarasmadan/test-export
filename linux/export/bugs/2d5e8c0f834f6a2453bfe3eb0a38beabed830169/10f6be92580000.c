// https://syzkaller.appspot.com/bug?id=2d5e8c0f834f6a2453bfe3eb0a38beabed830169
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

int main(void)
{
  syscall(__NR_mmap, /*addr=*/0x1ffffffff000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200000000000ul, /*len=*/0x1000000ul,
          /*prot=PROT_WRITE|PROT_READ|PROT_EXEC*/ 7ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200001000000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  const char* reason;
  (void)reason;
  if (write(1, "executing program\n", sizeof("executing program\n") - 1)) {
  }
  //  mq_open arguments: [
  //    name: ptr[in, buffer] {
  //      buffer: {62 61 74 61 64 76 5f 73 6c 61 76 65 5f 31 00 89 2f 3e 88 57
  //      d4 67 77 11 d5 3e 48 91 05 2c f1 91 22 07 bb b9 4d 87 22 7d e0 34 c5
  //      ee 77 0b 79 06 1d d2 d0 ce cd 31 67 e4 6f 58 bc ba 69 bc 4b 38 1a ca
  //      da 47 bf 78 99 2b 1c 94 e1 df 7c 93 71 a3 c7 27 77 f2 00 ac 78 00 45
  //      07 01} (length 0x5b)
  //    }
  //    flags: mq_open_flags = 0x6c9f928deea10f50 (8 bytes)
  //    mode: open_mode = 0x30 (8 bytes)
  //    attr: nil
  //  ]
  //  returns fd_mq
  memcpy((void*)0x200000000840,
         "batadv_slave_1\000\211/"
         ">\210W\324gw\021\325>H\221\005,\361\221\"\a\273\271M\207\"}"
         "\3404\305\356w\vy\006\035\322\320\316\3151g\344oX\274\272i\274K8\032"
         "\312\332G\277x\231+\034\224\341\337|"
         "\223q\243\307\'w\362\000\254x\000E\a\001",
         91);
  syscall(__NR_mq_open, /*name=*/0x200000000840ul,
          /*flags=O_CREAT|O_NONBLOCK|0x6c9f928deea10710*/ 0x6c9f928deea10f50ul,
          /*mode=S_IWGRP|S_IRGRP*/ 0x30ul, /*attr=*/0ul);
  //  mq_open arguments: [
  //    name: ptr[in, buffer] {
  //      buffer: {62 61 74 61 64 76 5f 73 6c 61 76 65 5f 31 00 89 2f 3e 88 57
  //      d4 67 77 11 d5 3e 48 91 05 2c f1 91 22 07 bb b9 4d 87 22 7d e0 34 c5
  //      ee 77 0b 79 06 1d d2 d0 ce cd 31 67 e4 6f 58 bc ba 69 bc 4b 38 1a ca
  //      da 47 bf 78 99 2b 1c 94 e1 df 7c 93 71 a3 c7 27 77 f2 00 ac 78 00 45
  //      07 01} (length 0x5b)
  //    }
  //    flags: mq_open_flags = 0x6c9f928deea10f50 (8 bytes)
  //    mode: open_mode = 0x30 (8 bytes)
  //    attr: nil
  //  ]
  //  returns fd_mq
  memcpy((void*)0x200000000840,
         "batadv_slave_1\000\211/"
         ">\210W\324gw\021\325>H\221\005,\361\221\"\a\273\271M\207\"}"
         "\3404\305\356w\vy\006\035\322\320\316\3151g\344oX\274\272i\274K8\032"
         "\312\332G\277x\231+\034\224\341\337|"
         "\223q\243\307\'w\362\000\254x\000E\a\001",
         91);
  syscall(__NR_mq_open, /*name=*/0x200000000840ul,
          /*flags=O_CREAT|O_NONBLOCK|0x6c9f928deea10710*/ 0x6c9f928deea10f50ul,
          /*mode=S_IWGRP|S_IRGRP*/ 0x30ul, /*attr=*/0ul);
  return 0;
}
