// https://syzkaller.appspot.com/bug?id=06a62b218743b65182c953962811f26c9d8be988
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <dirent.h>
#include <endian.h>
#include <errno.h>
#include <fcntl.h>
#include <signal.h>
#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/prctl.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <time.h>
#include <unistd.h>

#ifndef __NR_bpf
#define __NR_bpf 386
#endif
#ifndef __NR_mmap
#define __NR_mmap 192
#endif
#undef __NR_mmap
#define __NR_mmap __NR_mmap2

static void sleep_ms(uint64_t ms)
{
  usleep(ms * 1000);
}

static uint64_t current_time_ms(void)
{
  struct timespec ts;
  if (clock_gettime(CLOCK_MONOTONIC, &ts))
    exit(1);
  return (uint64_t)ts.tv_sec * 1000 + (uint64_t)ts.tv_nsec / 1000000;
}

static bool write_file(const char* file, const char* what, ...)
{
  char buf[1024];
  va_list args;
  va_start(args, what);
  vsnprintf(buf, sizeof(buf), what, args);
  va_end(args);
  buf[sizeof(buf) - 1] = 0;
  int len = strlen(buf);
  int fd = open(file, O_WRONLY | O_CLOEXEC);
  if (fd == -1)
    return false;
  if (write(fd, buf, len) != len) {
    int err = errno;
    close(fd);
    errno = err;
    return false;
  }
  close(fd);
  return true;
}

static void kill_and_wait(int pid, int* status)
{
  kill(-pid, SIGKILL);
  kill(pid, SIGKILL);
  for (int i = 0; i < 100; i++) {
    if (waitpid(-1, status, WNOHANG | __WALL) == pid)
      return;
    usleep(1000);
  }
  DIR* dir = opendir("/sys/fs/fuse/connections");
  if (dir) {
    for (;;) {
      struct dirent* ent = readdir(dir);
      if (!ent)
        break;
      if (strcmp(ent->d_name, ".") == 0 || strcmp(ent->d_name, "..") == 0)
        continue;
      char abort[300];
      snprintf(abort, sizeof(abort), "/sys/fs/fuse/connections/%s/abort",
               ent->d_name);
      int fd = open(abort, O_WRONLY);
      if (fd == -1) {
        continue;
      }
      if (write(fd, abort, 1) < 0) {
      }
      close(fd);
    }
    closedir(dir);
  } else {
  }
  while (waitpid(-1, status, __WALL) != pid) {
  }
}

static void setup_test()
{
  prctl(PR_SET_PDEATHSIG, SIGKILL, 0, 0, 0);
  setpgrp();
  write_file("/proc/self/oom_score_adj", "1000");
}

static void execute_one(void);

#define WAIT_FLAGS __WALL

static void loop(void)
{
  int iter = 0;
  for (;; iter++) {
    int pid = fork();
    if (pid < 0)
      exit(1);
    if (pid == 0) {
      setup_test();
      execute_one();
      exit(0);
    }
    int status = 0;
    uint64_t start = current_time_ms();
    for (;;) {
      sleep_ms(10);
      if (waitpid(-1, &status, WNOHANG | WAIT_FLAGS) == pid)
        break;
      if (current_time_ms() - start < 15000)
        continue;
      kill_and_wait(pid, &status);
      break;
    }
  }
}

void execute_one(void)
{
  if (write(1, "executing program\n", sizeof("executing program\n") - 1)) {
  }
  //  bpf$PROG_LOAD arguments: [
  //    cmd: const = 0x5 (4 bytes)
  //    arg: ptr[in, bpf_prog_t[flags[bpf_prog_type, int32],
  //    bpf_prog_attach_types, bpf_btf_id[opt], fd_bpf_prog[opt]]] {
  //      bpf_prog_t[flags[bpf_prog_type, int32], bpf_prog_attach_types,
  //      bpf_btf_id[opt], fd_bpf_prog[opt]] {
  //        type: bpf_prog_type = 0xe (4 bytes)
  //        ninsn: bytesize8 = 0x16 (4 bytes)
  //        insns: ptr[inout, array[ANYUNION]] {
  //          array[ANYUNION] {
  //            union ANYUNION {
  //              ANYBLOB: buffer: {61 15 88 00 00 00 00 00 61 13 50 00 00 00 00
  //              00 bf a0 00 00 00 00 00 00 07 00 00 00 ee 00 16 05 5e 03 01 00
  //              00 00 00 00 64 05 00 00 00 00 00 00 69 16 30 00 00 00 00 00 bf
  //              07 00 00 00 00 00 00 26 05 07 00 0f ff 07 20 67 06 00 00 20 00
  //              00 00 47 06 00 00 0e e6 00 60 bf 50 00 00 00 00 00 00 2f 65 00
  //              00 00 00 00 00 65 07 f9 ff 01 00 00 00 07 07 00 00 cd df ff ff
  //              1e 75 00 00 00 00 00 00 bf 54 00 00 00 00 00 00 07 04 00 00 04
  //              00 f9 ff ad 43 01 00 00 00 00 00 95 00 00 00 00 00 00 00 15 00
  //              00 00 00 00 00 00 95 00 00 00 00 00 00 00 32 ed 3c 12 dc 8c 27
  //              df 8e cf 26 4e 0f 84 f9 f1 7d 3c 30 e3 2f 17 54 55 8f 22 78 af
  //              6d 71 d7 9a 5e 12 81 4c b1 d8 a5 d4 60 1d 29 5c 45 a6 a0 b9 bd
  //              b7 dd 39 97 f9 c9 c4 f6 f3 be 4b 36 92 89 aa 68 12 b8 e0 07 e7
  //              33 a9 a4 f1 b0 af 3d da 82 ee 45 a0 10 fb 94 fe 9d e5 7b 9d 8a
  //              81 42 61 bd b9 4a 05 00 20 00 c6 c6 0b f7 0d 74 2a 81 76 2b ab
  //              83 95 fa 64 81 0b 5b 40 d8 93 ea 8f e0 18 54 73 d5 1b 54 6c ad
  //              3f 1d 5a ce 06 00 00 6e 7c 95 5c ce fa 1f 6a b6 89 b5 55 20 2d
  //              a2 e0 ec 28 71 b4 a7 e6 58 36 42 9a 52 7d c4 7e be 84 a4 23 b6
  //              c8 d3 45 dc 0d a3 08 5b 0a b7 1c a1 b9 01 62 7b 56 2e d0 4a e7
  //              60 02 d4 51 9a f6 19 e3 cc a4 d6 9e 0d ee 5e b1 06 77 4a 8f 3e
  //              69 16 df ec 88 15 8f 02 00 00 00 00 c8 fb 73 0a 5c 1b f2 b2 bb
  //              71 a6 29 36 19 97 a7 5f d5 52 bd c2 06 43 8b 8e f4 90 1f d0 3c
  //              16 df da 44 e2 a2 23 5c 8a c8 6d 8a 29 7d ff 04 45 a1 5f 21 dc
  //              e4 31 e5 67 23 88 8f b1 26 a1 63 f1 6f 92 0a e2 fb 49 40 59 bb
  //              a8 e3 b6 80 32 4a 18 80 76 eb 68 5d 00 c4 e9 b2 ad 9b c1 17 2b
  //              a7 cb eb e1 74 ab a2 10 d7 39 a0 18 f9 bb ec 63 22 2d 20 ce ca
  //              c4 d0 37 23 f1 c9 32 fb 3b ba 54 b3 a6 aa 57 f1 ad 2e 99 e0 e6
  //              7a b9 ff 16 d2 00 00 00 9f 0f 53 ac bb 40 b4 f8 e2 73 82 70 00
  //              15 62 ed 83 4f 2a f9 77 87 f6 96 64 9a 46 2e 7e e4 bc f8 b0 7a
  //              10 d6 73 51 54 be b4 00 00 00 00 00 00 00 00 00 00 00 00 00 40
  //              00 bc 00 f6 79 62 97 09 e7 e7 8f 4d dc 21 1b c3 eb e6 bd 9d 42
  //              ca 01 40 a7 af aa b4 31 76 e6 5e c1 11 8d 50 d1 e8 27 f3 47 2f
  //              44 45 d2 53 88 08 00 00 00 00 00 00 00 69 08 84 f8 00 03 1e 03
  //              a6 51 bb 96 58 9a 7e 2e 50 9b cc 1d 16 13 47 62 3c b5 e7 ac 46
  //              29 c8 ab 04 87 1b c4 72 87 cd 31 cc 43 01 00 00 00 7b 40 40 7d
  //              00 00 00 21 00 00 00 00 00 00 00 00 00 5f 37 d8 3f 84 e9 8a 52
  //              3d 80 bd 97 0d 70 3f 37 ca 36 4a 60 1a e8 99 a5 67 15 a0 a6 2a
  //              34 c6 c9 4c ce 69 94 52 16 29 ab 02 8a cf c1 d9 26 a0 f6 a5 48
  //              9a f8 dc 2f 17 92 3f 3c 40 df d1 97 0a 55 c2 2f e3 a5 ac 00 00
  //              00 00 00 00 00 00 00 00 00 00 00 00 00 c1 eb 2d 91 fb 79 ea 00
  //              00 00 00 81 52 66 b2 c9 e1 bf ad c7 49 8e 9d da 5d 00 00 00 bb
  //              0d 00 00 00 00 00 00 00 00 00 00 e4 00 7b e5 11 fe 32 fb c9 0e
  //              23 64 a5 5e 9b b6 6a c6 44 23 d2 d0 0f ea 25 94 e1 90 de ae 46
  //              e2 6c 59 6f 84 eb a9 00 00 00 00 00 00 00 3c c3 aa 39 ee 4b 13
  //              86 ba b5 61 cd a8 86 fa 64 29 94 ca cd 47 3b 54 3c cb 5f 0d 7b
  //              63 92 4f 17 c6 7b 13 63 18 22 a1 1d c3 c6 93 96 28 95 49 6d 4f
  //              6e 9c c5 4d b6 c7 20 5a 6b 26 f9 21 21 ef 53 e5 53 ac df 42 06
  //              8f ff 49 6d 2d a7 d6 32 7f 31 d7 c8 cc 5d 32 5c 53 79 b0 36 3c
  //              e8 bd 1f 61 b0 07 e1 ff 5f 1b e1 96 9a 1b a7 91 ad 46 d8 00 00
  //              00 00 c7 f2 6a 03 37 30 2f 3b 41 ea e5 98 09 fd 05 d1 2f 61 86
  //              f1 17 b0 62 df 67 d3 a6 3f 32 65 dd 14 10 ee a6 82 08 a3 f2 6b
  //              29 89 b8 32 d8 b3 4a 34 a4 f0 8b 34 b3 04 20 65 ac aa 10 85 6e
  //              85 8d 27 ad ee 7d af 32 90 3d 3f c7 87 00 d4 29 a2 d4 c8 b6 d8
  //              03 eb 83 ee cf e4 c7 ff 9e 6a b5 a5 2e 83 d0 89 da d7 a8 71 0e
  //              ec 53 f1 b1 1c ce d7 bc 3c 8d a0 c4 4d 2f bf 9f 6f 3f f3 be 4d
  //              14 58 07 7c 22 53 b0 c7 c7 a0 a9 fd d6 3b f9 10 dc 20 e5 cb 2a
  //              88 e5 9f eb c4 7f 12 12 a2 1f 63 1d ba a7 4f 22 ba d0 50 e9 85
  //              6b 48 ae 3a 03 a4 97 c3 77 58 53 76 50 fe 6d b8 03 00 c4 1f dc
  //              3d 78 e0 46 f6 16 0e 17 41 29 9e 8d c2 99 06 87 0e 64 31 ed 1e
  //              ab 5d 06 7a 18 3f 06 4b 06 0a 8e c1 27 25 d4 2e 3a 74 86 3d 66
  //              be e9 66 b1 57 4f 8e 01 b3 f3 4a 26 7f f0 af a1 e1 c7 58 a0 07
  //              9b 74 70 67 31 2e 98 15 a2 1c b3 f1 f8 15 0d 99 9d 78 85 35 a4
  //              d3 11 4d bc 7e 2b f2 40 2a 75 fd 7a 55 73 33 60 04 08 55 ed 5d
  //              1c 0d 63 4f c5 fb 38 f8 70 9d 87 b2 7f 8a 5d 91 21 fd c0 58 44
  //              7b 72 8f 13 4f 72 06 2f c4 b1 ca 07 80 b1 a7 af 13 7f f7 b4 ff
  //              13 96 04 fa f0 45 3b 65 58 6f 65 c7 94 3d 56 b5 2f 06 c8 70 ed
  //              f0 c5 d7 44 b5 27 2b 44 c2 34 80 b2 bd bf f9 47 c4 df a1 08 cb
  //              b8 82 02 ee b8 1f 42 8a 5b 3c 29 98 48 64 9e 1a 6b ff 52 f6 57
  //              a6 74 63 d7 db f8 5a e9 32 1f c2 cc 17 dc 4a 29 b9 cb a8 de d5
  //              de 82 06 c8 12 43 9a b1 29 ae 81 88 37 ee 15 62 07 8f c5 24 b3
  //              ba f4 9a 0b e9 bb 7d 95 8d 5e 87 c6 c0 9b f7 1a 89 4b ad 62 93
  //              47 82 cc 30 8e 93 6d 76 37 e0 7c 4a 2a 3b c8 7b 0d a2 00 00 d9
  //              ef 41 8c f1 9e 7a 8c 4c 32 8b e0 ce 91 79 8a dc 2d ca 87 10 73
  //              f6 bd 61 94 0a ab c8 6b 94 f8 cb de 4d 47 06 04 00 e7 22 a6 a2
  //              af 48 3a d0 d3 41 5e d0 f9 db 00 9a ca ba 9e ae a9 3f 81 1d 43
  //              4e 00 00 00 00 00 00 00 00 00 00 d1 54 67 2f ea 96 ae df 34 62
  //              79 ec 00 00 00 00 00 00 00 00 00 00 d5 35 d4 1b 00 67 f0 1e 2e
  //              54 b9 15 4d 87 60 20 b6 69 64 0e ad 4c a4 46 31 fa df 7c 4a c3
  //              9a 1b 33 1d bd cd 52 b3 6d f0 21 b7 31 ef 1f 92 33 0d 34 7f 88
  //              ce d5 c1 aa ad bc dd 8d 22 57 e3 a9 a7 c7 49 4f ad f9 be 36 f7
  //              a2 33 4e e6 e9 44 6f a1 fd 48 6f 85 d6 72 a7 7d c5 bd 21 46 39
  //              94 d4 9f 12 01 63 05 a1 e3 94 d2 92 b6 68 40 fe 32 b4 0a d6 65
  //              d2 41 a8 b8 a3 2b 31 00 45 0c 32 83 27 89 aa 8a 09 6f 41 20 1b
  //              58 5c d7 66 31 c8 8c f9 58 e9 e9 04 7f 5a f1 73 0c 5e 83 db 12
  //              46 0a 07 68 fd 4b 62 be 6c 41 ee d3 07 04 8b ac 8d 1f 7f 16 45
  //              74 24 1e 06 02 76 54 b2 48 dc c3 87 49 ee e0 c1 ee 7c 61 b3 f6
  //              41 1a 55 9c 3d 45 63 7b 11 e4 40 ed 5a 99 10 9b 8e 71 d2 8c 3d
  //              67 7a f5 f0 49 9c 6d 3f c6 a1 29 77 50 56 95 8c 9d f8 24 eb e5
  //              fa 9f b3 06 b2 4a 8a 83 34 91 06 27 d0 3e fe 69 d4 b6 1c 43 45
  //              f0 48 c5 da 8a ca 16 ce a8 48 fa 77 d2 50 7c 92 0a 6b d6 54 b0
  //              0e 07 78 93 82 ed 90 2c 80 de ef f2 fd 5c 78 f4 2e 43 53 e5 36
  //              0c 3e 55 96 2e fd 13 31 e6 73 6e af 4e e2 77 36 fa 54 80 3e e8
  //              ec 1a 15 26 6f fc d8 b3 03 68 74 0b 58 4c 25 59 e6 91 e5 42 ca
  //              b3 d4 9d b3 27 db 62 32 8f 15 9d 1e 09 00 b3 e2 3e 84 de dc d1
  //              37 7a a1 5d be ab 7d b1 81 bd 66 98 0c 35 57 c7 d9 f7 37 7f cb
  //              60 23 ac cb 5c 36 8a 12 1a cf 70 e5 f4 c3 f2 a0 ea 07 01 1c 71
  //              49 ea 97 9c ab 2e e6 5c f7 ff a2 91 52 b7 a8 fe d8 95 75 e6 e6
  //              fd 77 d4 d9 46 3d 21 77 5a ba c8 86 ee 6a 1f 2d 7d 85 23 84 04
  //              38 a7 3d 63 07 a8 7e 2f 52 58 67 fc 3a f7 ab 74 52 0a 77 3a e2
  //              6b ae 74 cd d4 05 a2 11 e8 83 3e 1b a5 23 cd e5 1d 04 a7 ca 67
  //              32} (length 0x81a)
  //            }
  //          }
  //        }
  //        license: ptr[in, buffer] {
  //          buffer: {47 50 4c 00} (length 0x4)
  //        }
  //        loglev: int32 = 0x0 (4 bytes)
  //        logsize: len = 0x0 (4 bytes)
  //        log: nil
  //        kern_version: bpf_kern_version = 0x0 (4 bytes)
  //        flags: bpf_prog_load_flags = 0x0 (4 bytes)
  //        prog_name: buffer: {00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
  //        (length 0x10) prog_ifindex: ifindex (resource) expected_attach_type:
  //        union bpf_prog_attach_types {
  //          sk_skb: sk_skb_attach_types = 0x0 (4 bytes)
  //        }
  //        btf_fd: fd_btf (resource)
  //        func_info_rec_size: const = 0x8 (4 bytes)
  //        func_info: ptr[in, bpf_func_info] {
  //          bpf_func_info {
  //            insn_off: int32 = 0x0 (4 bytes)
  //            type_id: int32 = 0x0 (4 bytes)
  //          }
  //        }
  //        func_info_cnt: len = 0xffffffffffffffd2 (4 bytes)
  //        line_info_rec_size: const = 0x10 (4 bytes)
  //        line_info: nil
  //        line_info_cnt: len = 0x0 (4 bytes)
  //        attach_btf_id: bpf_btf_id (resource)
  //        attach_prog_fd: fd_bpf_prog (resource)
  //        core_relo_cnt: len = 0x0 (4 bytes)
  //        fd_array: nil
  //        core_relos: nil
  //        core_relo_rec_size: const = 0x10 (4 bytes)
  //        log_true_size: int32 = 0x0 (4 bytes)
  //        prog_token_fd: union _bpf_prog_t[flags[bpf_prog_type, int32],
  //        bpf_prog_attach_types, bpf_btf_id[opt],
  //        fd_bpf_prog[opt]]_prog_token_fd_wrapper {
  //          void: buffer: {} (length 0x0)
  //        }
  //        pad: union _bpf_prog_t[flags[bpf_prog_type, int32],
  //        bpf_prog_attach_types, bpf_btf_id[opt],
  //        fd_bpf_prog[opt]]_pad_wrapper {
  //          value: const = 0x0 (4 bytes)
  //        }
  //      }
  //    }
  //    size: len = 0x48 (4 bytes)
  //  ]
  //  returns fd_bpf_prog
  *(uint32_t*)0x200054c0 = 0xe;
  *(uint32_t*)0x200054c4 = 0x16;
  *(uint64_t*)0x200054c8 = 0x20000940;
  memcpy(
      (void*)0x20000940,
      "\x61\x15\x88\x00\x00\x00\x00\x00\x61\x13\x50\x00\x00\x00\x00\x00\xbf\xa0"
      "\x00\x00\x00\x00\x00\x00\x07\x00\x00\x00\xee\x00\x16\x05\x5e\x03\x01\x00"
      "\x00\x00\x00\x00\x64\x05\x00\x00\x00\x00\x00\x00\x69\x16\x30\x00\x00\x00"
      "\x00\x00\xbf\x07\x00\x00\x00\x00\x00\x00\x26\x05\x07\x00\x0f\xff\x07\x20"
      "\x67\x06\x00\x00\x20\x00\x00\x00\x47\x06\x00\x00\x0e\xe6\x00\x60\xbf\x50"
      "\x00\x00\x00\x00\x00\x00\x2f\x65\x00\x00\x00\x00\x00\x00\x65\x07\xf9\xff"
      "\x01\x00\x00\x00\x07\x07\x00\x00\xcd\xdf\xff\xff\x1e\x75\x00\x00\x00\x00"
      "\x00\x00\xbf\x54\x00\x00\x00\x00\x00\x00\x07\x04\x00\x00\x04\x00\xf9\xff"
      "\xad\x43\x01\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x00\x00\x00\x15\x00"
      "\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x00\x00\x00\x32\xed\x3c\x12"
      "\xdc\x8c\x27\xdf\x8e\xcf\x26\x4e\x0f\x84\xf9\xf1\x7d\x3c\x30\xe3\x2f\x17"
      "\x54\x55\x8f\x22\x78\xaf\x6d\x71\xd7\x9a\x5e\x12\x81\x4c\xb1\xd8\xa5\xd4"
      "\x60\x1d\x29\x5c\x45\xa6\xa0\xb9\xbd\xb7\xdd\x39\x97\xf9\xc9\xc4\xf6\xf3"
      "\xbe\x4b\x36\x92\x89\xaa\x68\x12\xb8\xe0\x07\xe7\x33\xa9\xa4\xf1\xb0\xaf"
      "\x3d\xda\x82\xee\x45\xa0\x10\xfb\x94\xfe\x9d\xe5\x7b\x9d\x8a\x81\x42\x61"
      "\xbd\xb9\x4a\x05\x00\x20\x00\xc6\xc6\x0b\xf7\x0d\x74\x2a\x81\x76\x2b\xab"
      "\x83\x95\xfa\x64\x81\x0b\x5b\x40\xd8\x93\xea\x8f\xe0\x18\x54\x73\xd5\x1b"
      "\x54\x6c\xad\x3f\x1d\x5a\xce\x06\x00\x00\x6e\x7c\x95\x5c\xce\xfa\x1f\x6a"
      "\xb6\x89\xb5\x55\x20\x2d\xa2\xe0\xec\x28\x71\xb4\xa7\xe6\x58\x36\x42\x9a"
      "\x52\x7d\xc4\x7e\xbe\x84\xa4\x23\xb6\xc8\xd3\x45\xdc\x0d\xa3\x08\x5b\x0a"
      "\xb7\x1c\xa1\xb9\x01\x62\x7b\x56\x2e\xd0\x4a\xe7\x60\x02\xd4\x51\x9a\xf6"
      "\x19\xe3\xcc\xa4\xd6\x9e\x0d\xee\x5e\xb1\x06\x77\x4a\x8f\x3e\x69\x16\xdf"
      "\xec\x88\x15\x8f\x02\x00\x00\x00\x00\xc8\xfb\x73\x0a\x5c\x1b\xf2\xb2\xbb"
      "\x71\xa6\x29\x36\x19\x97\xa7\x5f\xd5\x52\xbd\xc2\x06\x43\x8b\x8e\xf4\x90"
      "\x1f\xd0\x3c\x16\xdf\xda\x44\xe2\xa2\x23\x5c\x8a\xc8\x6d\x8a\x29\x7d\xff"
      "\x04\x45\xa1\x5f\x21\xdc\xe4\x31\xe5\x67\x23\x88\x8f\xb1\x26\xa1\x63\xf1"
      "\x6f\x92\x0a\xe2\xfb\x49\x40\x59\xbb\xa8\xe3\xb6\x80\x32\x4a\x18\x80\x76"
      "\xeb\x68\x5d\x00\xc4\xe9\xb2\xad\x9b\xc1\x17\x2b\xa7\xcb\xeb\xe1\x74\xab"
      "\xa2\x10\xd7\x39\xa0\x18\xf9\xbb\xec\x63\x22\x2d\x20\xce\xca\xc4\xd0\x37"
      "\x23\xf1\xc9\x32\xfb\x3b\xba\x54\xb3\xa6\xaa\x57\xf1\xad\x2e\x99\xe0\xe6"
      "\x7a\xb9\xff\x16\xd2\x00\x00\x00\x9f\x0f\x53\xac\xbb\x40\xb4\xf8\xe2\x73"
      "\x82\x70\x00\x15\x62\xed\x83\x4f\x2a\xf9\x77\x87\xf6\x96\x64\x9a\x46\x2e"
      "\x7e\xe4\xbc\xf8\xb0\x7a\x10\xd6\x73\x51\x54\xbe\xb4\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\xbc\x00\xf6\x79\x62\x97\x09\xe7"
      "\xe7\x8f\x4d\xdc\x21\x1b\xc3\xeb\xe6\xbd\x9d\x42\xca\x01\x40\xa7\xaf\xaa"
      "\xb4\x31\x76\xe6\x5e\xc1\x11\x8d\x50\xd1\xe8\x27\xf3\x47\x2f\x44\x45\xd2"
      "\x53\x88\x08\x00\x00\x00\x00\x00\x00\x00\x69\x08\x84\xf8\x00\x03\x1e\x03"
      "\xa6\x51\xbb\x96\x58\x9a\x7e\x2e\x50\x9b\xcc\x1d\x16\x13\x47\x62\x3c\xb5"
      "\xe7\xac\x46\x29\xc8\xab\x04\x87\x1b\xc4\x72\x87\xcd\x31\xcc\x43\x01\x00"
      "\x00\x00\x7b\x40\x40\x7d\x00\x00\x00\x21\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x5f\x37\xd8\x3f\x84\xe9\x8a\x52\x3d\x80\xbd\x97\x0d\x70\x3f\x37\xca"
      "\x36\x4a\x60\x1a\xe8\x99\xa5\x67\x15\xa0\xa6\x2a\x34\xc6\xc9\x4c\xce\x69"
      "\x94\x52\x16\x29\xab\x02\x8a\xcf\xc1\xd9\x26\xa0\xf6\xa5\x48\x9a\xf8\xdc"
      "\x2f\x17\x92\x3f\x3c\x40\xdf\xd1\x97\x0a\x55\xc2\x2f\xe3\xa5\xac\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\xeb\x2d\x91\xfb"
      "\x79\xea\x00\x00\x00\x00\x81\x52\x66\xb2\xc9\xe1\xbf\xad\xc7\x49\x8e\x9d"
      "\xda\x5d\x00\x00\x00\xbb\x0d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe4"
      "\x00\x7b\xe5\x11\xfe\x32\xfb\xc9\x0e\x23\x64\xa5\x5e\x9b\xb6\x6a\xc6\x44"
      "\x23\xd2\xd0\x0f\xea\x25\x94\xe1\x90\xde\xae\x46\xe2\x6c\x59\x6f\x84\xeb"
      "\xa9\x00\x00\x00\x00\x00\x00\x00\x3c\xc3\xaa\x39\xee\x4b\x13\x86\xba\xb5"
      "\x61\xcd\xa8\x86\xfa\x64\x29\x94\xca\xcd\x47\x3b\x54\x3c\xcb\x5f\x0d\x7b"
      "\x63\x92\x4f\x17\xc6\x7b\x13\x63\x18\x22\xa1\x1d\xc3\xc6\x93\x96\x28\x95"
      "\x49\x6d\x4f\x6e\x9c\xc5\x4d\xb6\xc7\x20\x5a\x6b\x26\xf9\x21\x21\xef\x53"
      "\xe5\x53\xac\xdf\x42\x06\x8f\xff\x49\x6d\x2d\xa7\xd6\x32\x7f\x31\xd7\xc8"
      "\xcc\x5d\x32\x5c\x53\x79\xb0\x36\x3c\xe8\xbd\x1f\x61\xb0\x07\xe1\xff\x5f"
      "\x1b\xe1\x96\x9a\x1b\xa7\x91\xad\x46\xd8\x00\x00\x00\x00\xc7\xf2\x6a\x03"
      "\x37\x30\x2f\x3b\x41\xea\xe5\x98\x09\xfd\x05\xd1\x2f\x61\x86\xf1\x17\xb0"
      "\x62\xdf\x67\xd3\xa6\x3f\x32\x65\xdd\x14\x10\xee\xa6\x82\x08\xa3\xf2\x6b"
      "\x29\x89\xb8\x32\xd8\xb3\x4a\x34\xa4\xf0\x8b\x34\xb3\x04\x20\x65\xac\xaa"
      "\x10\x85\x6e\x85\x8d\x27\xad\xee\x7d\xaf\x32\x90\x3d\x3f\xc7\x87\x00\xd4"
      "\x29\xa2\xd4\xc8\xb6\xd8\x03\xeb\x83\xee\xcf\xe4\xc7\xff\x9e\x6a\xb5\xa5"
      "\x2e\x83\xd0\x89\xda\xd7\xa8\x71\x0e\xec\x53\xf1\xb1\x1c\xce\xd7\xbc\x3c"
      "\x8d\xa0\xc4\x4d\x2f\xbf\x9f\x6f\x3f\xf3\xbe\x4d\x14\x58\x07\x7c\x22\x53"
      "\xb0\xc7\xc7\xa0\xa9\xfd\xd6\x3b\xf9\x10\xdc\x20\xe5\xcb\x2a\x88\xe5\x9f"
      "\xeb\xc4\x7f\x12\x12\xa2\x1f\x63\x1d\xba\xa7\x4f\x22\xba\xd0\x50\xe9\x85"
      "\x6b\x48\xae\x3a\x03\xa4\x97\xc3\x77\x58\x53\x76\x50\xfe\x6d\xb8\x03\x00"
      "\xc4\x1f\xdc\x3d\x78\xe0\x46\xf6\x16\x0e\x17\x41\x29\x9e\x8d\xc2\x99\x06"
      "\x87\x0e\x64\x31\xed\x1e\xab\x5d\x06\x7a\x18\x3f\x06\x4b\x06\x0a\x8e\xc1"
      "\x27\x25\xd4\x2e\x3a\x74\x86\x3d\x66\xbe\xe9\x66\xb1\x57\x4f\x8e\x01\xb3"
      "\xf3\x4a\x26\x7f\xf0\xaf\xa1\xe1\xc7\x58\xa0\x07\x9b\x74\x70\x67\x31\x2e"
      "\x98\x15\xa2\x1c\xb3\xf1\xf8\x15\x0d\x99\x9d\x78\x85\x35\xa4\xd3\x11\x4d"
      "\xbc\x7e\x2b\xf2\x40\x2a\x75\xfd\x7a\x55\x73\x33\x60\x04\x08\x55\xed\x5d"
      "\x1c\x0d\x63\x4f\xc5\xfb\x38\xf8\x70\x9d\x87\xb2\x7f\x8a\x5d\x91\x21\xfd"
      "\xc0\x58\x44\x7b\x72\x8f\x13\x4f\x72\x06\x2f\xc4\xb1\xca\x07\x80\xb1\xa7"
      "\xaf\x13\x7f\xf7\xb4\xff\x13\x96\x04\xfa\xf0\x45\x3b\x65\x58\x6f\x65\xc7"
      "\x94\x3d\x56\xb5\x2f\x06\xc8\x70\xed\xf0\xc5\xd7\x44\xb5\x27\x2b\x44\xc2"
      "\x34\x80\xb2\xbd\xbf\xf9\x47\xc4\xdf\xa1\x08\xcb\xb8\x82\x02\xee\xb8\x1f"
      "\x42\x8a\x5b\x3c\x29\x98\x48\x64\x9e\x1a\x6b\xff\x52\xf6\x57\xa6\x74\x63"
      "\xd7\xdb\xf8\x5a\xe9\x32\x1f\xc2\xcc\x17\xdc\x4a\x29\xb9\xcb\xa8\xde\xd5"
      "\xde\x82\x06\xc8\x12\x43\x9a\xb1\x29\xae\x81\x88\x37\xee\x15\x62\x07\x8f"
      "\xc5\x24\xb3\xba\xf4\x9a\x0b\xe9\xbb\x7d\x95\x8d\x5e\x87\xc6\xc0\x9b\xf7"
      "\x1a\x89\x4b\xad\x62\x93\x47\x82\xcc\x30\x8e\x93\x6d\x76\x37\xe0\x7c\x4a"
      "\x2a\x3b\xc8\x7b\x0d\xa2\x00\x00\xd9\xef\x41\x8c\xf1\x9e\x7a\x8c\x4c\x32"
      "\x8b\xe0\xce\x91\x79\x8a\xdc\x2d\xca\x87\x10\x73\xf6\xbd\x61\x94\x0a\xab"
      "\xc8\x6b\x94\xf8\xcb\xde\x4d\x47\x06\x04\x00\xe7\x22\xa6\xa2\xaf\x48\x3a"
      "\xd0\xd3\x41\x5e\xd0\xf9\xdb\x00\x9a\xca\xba\x9e\xae\xa9\x3f\x81\x1d\x43"
      "\x4e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd1\x54\x67\x2f\xea\x96\xae"
      "\xdf\x34\x62\x79\xec\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd5\x35\xd4"
      "\x1b\x00\x67\xf0\x1e\x2e\x54\xb9\x15\x4d\x87\x60\x20\xb6\x69\x64\x0e\xad"
      "\x4c\xa4\x46\x31\xfa\xdf\x7c\x4a\xc3\x9a\x1b\x33\x1d\xbd\xcd\x52\xb3\x6d"
      "\xf0\x21\xb7\x31\xef\x1f\x92\x33\x0d\x34\x7f\x88\xce\xd5\xc1\xaa\xad\xbc"
      "\xdd\x8d\x22\x57\xe3\xa9\xa7\xc7\x49\x4f\xad\xf9\xbe\x36\xf7\xa2\x33\x4e"
      "\xe6\xe9\x44\x6f\xa1\xfd\x48\x6f\x85\xd6\x72\xa7\x7d\xc5\xbd\x21\x46\x39"
      "\x94\xd4\x9f\x12\x01\x63\x05\xa1\xe3\x94\xd2\x92\xb6\x68\x40\xfe\x32\xb4"
      "\x0a\xd6\x65\xd2\x41\xa8\xb8\xa3\x2b\x31\x00\x45\x0c\x32\x83\x27\x89\xaa"
      "\x8a\x09\x6f\x41\x20\x1b\x58\x5c\xd7\x66\x31\xc8\x8c\xf9\x58\xe9\xe9\x04"
      "\x7f\x5a\xf1\x73\x0c\x5e\x83\xdb\x12\x46\x0a\x07\x68\xfd\x4b\x62\xbe\x6c"
      "\x41\xee\xd3\x07\x04\x8b\xac\x8d\x1f\x7f\x16\x45\x74\x24\x1e\x06\x02\x76"
      "\x54\xb2\x48\xdc\xc3\x87\x49\xee\xe0\xc1\xee\x7c\x61\xb3\xf6\x41\x1a\x55"
      "\x9c\x3d\x45\x63\x7b\x11\xe4\x40\xed\x5a\x99\x10\x9b\x8e\x71\xd2\x8c\x3d"
      "\x67\x7a\xf5\xf0\x49\x9c\x6d\x3f\xc6\xa1\x29\x77\x50\x56\x95\x8c\x9d\xf8"
      "\x24\xeb\xe5\xfa\x9f\xb3\x06\xb2\x4a\x8a\x83\x34\x91\x06\x27\xd0\x3e\xfe"
      "\x69\xd4\xb6\x1c\x43\x45\xf0\x48\xc5\xda\x8a\xca\x16\xce\xa8\x48\xfa\x77"
      "\xd2\x50\x7c\x92\x0a\x6b\xd6\x54\xb0\x0e\x07\x78\x93\x82\xed\x90\x2c\x80"
      "\xde\xef\xf2\xfd\x5c\x78\xf4\x2e\x43\x53\xe5\x36\x0c\x3e\x55\x96\x2e\xfd"
      "\x13\x31\xe6\x73\x6e\xaf\x4e\xe2\x77\x36\xfa\x54\x80\x3e\xe8\xec\x1a\x15"
      "\x26\x6f\xfc\xd8\xb3\x03\x68\x74\x0b\x58\x4c\x25\x59\xe6\x91\xe5\x42\xca"
      "\xb3\xd4\x9d\xb3\x27\xdb\x62\x32\x8f\x15\x9d\x1e\x09\x00\xb3\xe2\x3e\x84"
      "\xde\xdc\xd1\x37\x7a\xa1\x5d\xbe\xab\x7d\xb1\x81\xbd\x66\x98\x0c\x35\x57"
      "\xc7\xd9\xf7\x37\x7f\xcb\x60\x23\xac\xcb\x5c\x36\x8a\x12\x1a\xcf\x70\xe5"
      "\xf4\xc3\xf2\xa0\xea\x07\x01\x1c\x71\x49\xea\x97\x9c\xab\x2e\xe6\x5c\xf7"
      "\xff\xa2\x91\x52\xb7\xa8\xfe\xd8\x95\x75\xe6\xe6\xfd\x77\xd4\xd9\x46\x3d"
      "\x21\x77\x5a\xba\xc8\x86\xee\x6a\x1f\x2d\x7d\x85\x23\x84\x04\x38\xa7\x3d"
      "\x63\x07\xa8\x7e\x2f\x52\x58\x67\xfc\x3a\xf7\xab\x74\x52\x0a\x77\x3a\xe2"
      "\x6b\xae\x74\xcd\xd4\x05\xa2\x11\xe8\x83\x3e\x1b\xa5\x23\xcd\xe5\x1d\x04"
      "\xa7\xca\x67\x32",
      2074);
  *(uint64_t*)0x200054d0 = 0x20000100;
  memcpy((void*)0x20000100, "GPL\000", 4);
  *(uint32_t*)0x200054d8 = 0;
  *(uint32_t*)0x200054dc = 0;
  *(uint64_t*)0x200054e0 = 0;
  *(uint32_t*)0x200054e8 = 0;
  *(uint32_t*)0x200054ec = 0;
  memset((void*)0x200054f0, 0, 16);
  *(uint32_t*)0x20005500 = 0;
  *(uint32_t*)0x20005504 = 0;
  *(uint32_t*)0x20005508 = -1;
  *(uint32_t*)0x2000550c = 8;
  *(uint64_t*)0x20005510 = 0x20000000;
  *(uint32_t*)0x20000000 = 0;
  *(uint32_t*)0x20000004 = 0;
  *(uint32_t*)0x20005518 = 0xffffffd2;
  *(uint32_t*)0x2000551c = 0x10;
  *(uint64_t*)0x20005520 = 0;
  *(uint32_t*)0x20005528 = 0;
  *(uint32_t*)0x2000552c = 0;
  *(uint32_t*)0x20005530 = -1;
  *(uint32_t*)0x20005534 = 0;
  *(uint64_t*)0x20005538 = 0;
  *(uint64_t*)0x20005540 = 0;
  *(uint32_t*)0x20005548 = 0x10;
  *(uint32_t*)0x2000554c = 0;
  *(uint32_t*)0x20005550 = 0;
  syscall(__NR_bpf, /*cmd=*/5, /*arg=*/0x200054c0, /*size=*/0x48);
}
int main(void)
{
  syscall(__NR_mmap, /*addr=*/0x1ffff000, /*len=*/0x1000, /*prot=*/0,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32,
          /*fd=*/(intptr_t)-1, /*offset=*/0);
  syscall(__NR_mmap, /*addr=*/0x20000000, /*len=*/0x1000000,
          /*prot=PROT_WRITE|PROT_READ|PROT_EXEC*/ 7,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32,
          /*fd=*/(intptr_t)-1, /*offset=*/0);
  syscall(__NR_mmap, /*addr=*/0x21000000, /*len=*/0x1000, /*prot=*/0,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32,
          /*fd=*/(intptr_t)-1, /*offset=*/0);
  const char* reason;
  (void)reason;
  loop();
  return 0;
}
