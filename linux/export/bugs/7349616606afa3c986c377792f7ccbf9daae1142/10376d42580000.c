// https://syzkaller.appspot.com/bug?id=7349616606afa3c986c377792f7ccbf9daae1142
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <dirent.h>
#include <endian.h>
#include <errno.h>
#include <fcntl.h>
#include <pthread.h>
#include <setjmp.h>
#include <signal.h>
#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/prctl.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <time.h>
#include <unistd.h>

#include <linux/futex.h>

#ifndef __NR_bpf
#define __NR_bpf 321
#endif

static unsigned long long procid;

static __thread int clone_ongoing;
static __thread int skip_segv;
static __thread jmp_buf segv_env;

static void segv_handler(int sig, siginfo_t* info, void* ctx)
{
  if (__atomic_load_n(&clone_ongoing, __ATOMIC_RELAXED) != 0) {
    exit(sig);
  }
  uintptr_t addr = (uintptr_t)info->si_addr;
  const uintptr_t prog_start = 1 << 20;
  const uintptr_t prog_end = 100 << 20;
  int skip = __atomic_load_n(&skip_segv, __ATOMIC_RELAXED) != 0;
  int valid = addr < prog_start || addr > prog_end;
  if (skip && valid) {
    _longjmp(segv_env, 1);
  }
  exit(sig);
}

static void install_segv_handler(void)
{
  struct sigaction sa;
  memset(&sa, 0, sizeof(sa));
  sa.sa_handler = SIG_IGN;
  syscall(SYS_rt_sigaction, 0x20, &sa, NULL, 8);
  syscall(SYS_rt_sigaction, 0x21, &sa, NULL, 8);
  memset(&sa, 0, sizeof(sa));
  sa.sa_sigaction = segv_handler;
  sa.sa_flags = SA_NODEFER | SA_SIGINFO;
  sigaction(SIGSEGV, &sa, NULL);
  sigaction(SIGBUS, &sa, NULL);
}

#define NONFAILING(...)                                                        \
  ({                                                                           \
    int ok = 1;                                                                \
    __atomic_fetch_add(&skip_segv, 1, __ATOMIC_SEQ_CST);                       \
    if (_setjmp(segv_env) == 0) {                                              \
      __VA_ARGS__;                                                             \
    } else                                                                     \
      ok = 0;                                                                  \
    __atomic_fetch_sub(&skip_segv, 1, __ATOMIC_SEQ_CST);                       \
    ok;                                                                        \
  })

static void sleep_ms(uint64_t ms)
{
  usleep(ms * 1000);
}

static uint64_t current_time_ms(void)
{
  struct timespec ts;
  if (clock_gettime(CLOCK_MONOTONIC, &ts))
    exit(1);
  return (uint64_t)ts.tv_sec * 1000 + (uint64_t)ts.tv_nsec / 1000000;
}

static void thread_start(void* (*fn)(void*), void* arg)
{
  pthread_t th;
  pthread_attr_t attr;
  pthread_attr_init(&attr);
  pthread_attr_setstacksize(&attr, 128 << 10);
  int i = 0;
  for (; i < 100; i++) {
    if (pthread_create(&th, &attr, fn, arg) == 0) {
      pthread_attr_destroy(&attr);
      return;
    }
    if (errno == EAGAIN) {
      usleep(50);
      continue;
    }
    break;
  }
  exit(1);
}

typedef struct {
  int state;
} event_t;

static void event_init(event_t* ev)
{
  ev->state = 0;
}

static void event_reset(event_t* ev)
{
  ev->state = 0;
}

static void event_set(event_t* ev)
{
  if (ev->state)
    exit(1);
  __atomic_store_n(&ev->state, 1, __ATOMIC_RELEASE);
  syscall(SYS_futex, &ev->state, FUTEX_WAKE | FUTEX_PRIVATE_FLAG, 1000000);
}

static void event_wait(event_t* ev)
{
  while (!__atomic_load_n(&ev->state, __ATOMIC_ACQUIRE))
    syscall(SYS_futex, &ev->state, FUTEX_WAIT | FUTEX_PRIVATE_FLAG, 0, 0);
}

static int event_isset(event_t* ev)
{
  return __atomic_load_n(&ev->state, __ATOMIC_ACQUIRE);
}

static int event_timedwait(event_t* ev, uint64_t timeout)
{
  uint64_t start = current_time_ms();
  uint64_t now = start;
  for (;;) {
    uint64_t remain = timeout - (now - start);
    struct timespec ts;
    ts.tv_sec = remain / 1000;
    ts.tv_nsec = (remain % 1000) * 1000 * 1000;
    syscall(SYS_futex, &ev->state, FUTEX_WAIT | FUTEX_PRIVATE_FLAG, 0, &ts);
    if (__atomic_load_n(&ev->state, __ATOMIC_ACQUIRE))
      return 1;
    now = current_time_ms();
    if (now - start > timeout)
      return 0;
  }
}

static bool write_file(const char* file, const char* what, ...)
{
  char buf[1024];
  va_list args;
  va_start(args, what);
  vsnprintf(buf, sizeof(buf), what, args);
  va_end(args);
  buf[sizeof(buf) - 1] = 0;
  int len = strlen(buf);
  int fd = open(file, O_WRONLY | O_CLOEXEC);
  if (fd == -1)
    return false;
  if (write(fd, buf, len) != len) {
    int err = errno;
    close(fd);
    errno = err;
    return false;
  }
  close(fd);
  return true;
}

static long syz_open_dev(volatile long a0, volatile long a1, volatile long a2)
{
  if (a0 == 0xc || a0 == 0xb) {
    char buf[128];
    sprintf(buf, "/dev/%s/%d:%d", a0 == 0xc ? "char" : "block", (uint8_t)a1,
            (uint8_t)a2);
    return open(buf, O_RDWR, 0);
  } else {
    unsigned long nb = a1;
    char buf[1024];
    char* hash;
    strncpy(buf, (char*)a0, sizeof(buf) - 1);
    buf[sizeof(buf) - 1] = 0;
    while ((hash = strchr(buf, '#'))) {
      *hash = '0' + (char)(nb % 10);
      nb /= 10;
    }
    return open(buf, a2, 0);
  }
}

static void kill_and_wait(int pid, int* status)
{
  kill(-pid, SIGKILL);
  kill(pid, SIGKILL);
  for (int i = 0; i < 100; i++) {
    if (waitpid(-1, status, WNOHANG | __WALL) == pid)
      return;
    usleep(1000);
  }
  DIR* dir = opendir("/sys/fs/fuse/connections");
  if (dir) {
    for (;;) {
      struct dirent* ent = readdir(dir);
      if (!ent)
        break;
      if (strcmp(ent->d_name, ".") == 0 || strcmp(ent->d_name, "..") == 0)
        continue;
      char abort[300];
      snprintf(abort, sizeof(abort), "/sys/fs/fuse/connections/%s/abort",
               ent->d_name);
      int fd = open(abort, O_WRONLY);
      if (fd == -1) {
        continue;
      }
      if (write(fd, abort, 1) < 0) {
      }
      close(fd);
    }
    closedir(dir);
  } else {
  }
  while (waitpid(-1, status, __WALL) != pid) {
  }
}

static void setup_test()
{
  prctl(PR_SET_PDEATHSIG, SIGKILL, 0, 0, 0);
  setpgrp();
  write_file("/proc/self/oom_score_adj", "1000");
}

static void setup_sysctl()
{
  int cad_pid = fork();
  if (cad_pid < 0)
    exit(1);
  if (cad_pid == 0) {
    for (;;)
      sleep(100);
  }
  char tmppid[32];
  snprintf(tmppid, sizeof(tmppid), "%d", cad_pid);
  struct {
    const char* name;
    const char* data;
  } files[] = {
      {"/sys/kernel/debug/x86/nmi_longest_ns", "10000000000"},
      {"/proc/sys/kernel/hung_task_check_interval_secs", "20"},
      {"/proc/sys/net/core/bpf_jit_kallsyms", "1"},
      {"/proc/sys/net/core/bpf_jit_harden", "0"},
      {"/proc/sys/kernel/kptr_restrict", "0"},
      {"/proc/sys/kernel/softlockup_all_cpu_backtrace", "1"},
      {"/proc/sys/fs/mount-max", "100"},
      {"/proc/sys/vm/oom_dump_tasks", "0"},
      {"/proc/sys/debug/exception-trace", "0"},
      {"/proc/sys/kernel/printk", "7 4 1 3"},
      {"/proc/sys/kernel/keys/gc_delay", "1"},
      {"/proc/sys/vm/oom_kill_allocating_task", "1"},
      {"/proc/sys/kernel/ctrl-alt-del", "0"},
      {"/proc/sys/kernel/cad_pid", tmppid},
  };
  for (size_t i = 0; i < sizeof(files) / sizeof(files[0]); i++) {
    if (!write_file(files[i].name, files[i].data)) {
    }
  }
  kill(cad_pid, SIGKILL);
  while (waitpid(cad_pid, NULL, 0) != cad_pid)
    ;
}

struct thread_t {
  int created, call;
  event_t ready, done;
};

static struct thread_t threads[16];
static void execute_call(int call);
static int running;

static void* thr(void* arg)
{
  struct thread_t* th = (struct thread_t*)arg;
  for (;;) {
    event_wait(&th->ready);
    event_reset(&th->ready);
    execute_call(th->call);
    __atomic_fetch_sub(&running, 1, __ATOMIC_RELAXED);
    event_set(&th->done);
  }
  return 0;
}

static void execute_one(void)
{
  if (write(1, "executing program\n", sizeof("executing program\n") - 1)) {
  }
  int i, call, thread;
  for (call = 0; call < 16; call++) {
    for (thread = 0; thread < (int)(sizeof(threads) / sizeof(threads[0]));
         thread++) {
      struct thread_t* th = &threads[thread];
      if (!th->created) {
        th->created = 1;
        event_init(&th->ready);
        event_init(&th->done);
        event_set(&th->done);
        thread_start(thr, th);
      }
      if (!event_isset(&th->done))
        continue;
      event_reset(&th->done);
      th->call = call;
      __atomic_fetch_add(&running, 1, __ATOMIC_RELAXED);
      event_set(&th->ready);
      if (call == 0 || call == 4 || call == 6 || call == 14)
        break;
      event_timedwait(&th->done,
                      50 + (call == 4 ? 500 : 0) + (call == 5 ? 500 : 0));
      break;
    }
  }
  for (i = 0; i < 100 && __atomic_load_n(&running, __ATOMIC_RELAXED); i++)
    sleep_ms(1);
}

static void execute_one(void);

#define WAIT_FLAGS __WALL

static void loop(void)
{
  int iter = 0;
  for (;; iter++) {
    int pid = fork();
    if (pid < 0)
      exit(1);
    if (pid == 0) {
      setup_test();
      execute_one();
      exit(0);
    }
    int status = 0;
    uint64_t start = current_time_ms();
    for (;;) {
      sleep_ms(10);
      if (waitpid(-1, &status, WNOHANG | WAIT_FLAGS) == pid)
        break;
      if (current_time_ms() - start < 5000)
        continue;
      kill_and_wait(pid, &status);
      break;
    }
  }
}

uint64_t r[2] = {0x0, 0xffffffffffffffff};

void execute_call(int call)
{
  intptr_t res = 0;
  switch (call) {
  case 0:
    //  openat$sequencer arguments: [
    //    fd: const = 0xffffffffffffff9c (8 bytes)
    //    file: nil
    //    flags: open_flags = 0x20001 (4 bytes)
    //    mode: const = 0x0 (2 bytes)
    //  ]
    //  returns fd_seq
    syscall(__NR_openat, /*fd=*/0xffffffffffffff9cul, /*file=*/0ul,
            /*flags=O_NOFOLLOW|O_WRONLY*/ 0x20001, /*mode=*/0);
    break;
  case 1:
    //  syz_open_dev$video4linux arguments: [
    //    dev: nil
    //    id: intptr = 0x5 (8 bytes)
    //    flags: open_flags = 0x848120 (8 bytes)
    //  ]
    //  returns fd_video
    NONFAILING(syz_open_dev(
        /*dev=*/0, /*id=*/5,
        /*flags=O_NOCTTY|O_NOATIME|O_LARGEFILE|0x800020*/ 0x848120));
    break;
  case 2:
    //  add_key arguments: [
    //    type: nil
    //    desc: nil
    //    payload: nil
    //    paylen: len = 0x0 (8 bytes)
    //    keyring: keyring (resource)
    //  ]
    //  returns key
    res = syscall(__NR_add_key, /*type=*/0ul, /*desc=*/0ul, /*payload=*/0ul,
                  /*paylen=*/0ul, /*keyring=*/0xfffffffd);
    if (res != -1)
      r[0] = res;
    break;
  case 3:
    //  bpf$PROG_LOAD arguments: [
    //    cmd: const = 0x5 (8 bytes)
    //    arg: ptr[in, bpf_prog_t[flags[bpf_prog_type, int32],
    //    bpf_prog_attach_types, bpf_btf_id[opt], fd_bpf_prog[opt]]] {
    //      bpf_prog_t[flags[bpf_prog_type, int32], bpf_prog_attach_types,
    //      bpf_btf_id[opt], fd_bpf_prog[opt]] {
    //        type: bpf_prog_type = 0x11 (4 bytes)
    //        ninsn: bytesize8 = 0x8 (4 bytes)
    //        insns: ptr[inout, array[ANYUNION]] {
    //          array[ANYUNION] {
    //            union ANYUNION {
    //              ANYBLOB: buffer: {62 0a f8 ff 0c 20 00 21 bf a1 00 00 00 00
    //              00 00 07 01 00 00 f8 ff ff ff b7 02 00 00 03 00 00 00 bd 12
    //              00 00 00 00 00 00 85 00 00 00 06 00 00 00 b7 00 00 00 00 00
    //              00 00 95 00 00 00 00 00 00 00 3f af 4f 1e 7f 2a a3 d9 b1 8e
    //              d8 1c 0c 86 9b 51 ec 6c 0a f4 e0 e4 a9 44 6c 76 70 56 89 82
    //              b4 e0 20 f6 98 39 3a a0 f3 88 1f 9c 24 aa 56 f1 51 99 fa d0
    //              09 3c 59 d6 6b 5e ce 9f 36 c7 0d 0f 13 90 5e a2 3c 22 62 4c
    //              9f 87 f9 79 3f 50 bb 54 60 40 67 7b 0c 50 77 da 80 fb 98 2c
    //              1e 94 00 e6 93 14 6c ea 48 4a 41 5b 76 96 61 18 b6 4f 75 1a
    //              0f 24 1b 07 2e 90 08 00 08 00 2d 75 59 3a 28 6c ec c9 3e 64
    //              c2 27 c9 5a a0 b7 84 62 57 04 f0 7a 72 c2 34 66 4c 0a f9 36
    //              0a 1f 7a 5e 6b 60 71 30 c8 9f 18 c0 c1 08 9d 8b 85 32 89 e0
    //              1a a2 7a e8 b0 9e 00 e7 9a b2 0b 0b 8e 11 48 f4 9f af 2a d0
    //              00 00 00 00 00 00 00 6f a0 3c 64 68 97 20 89 b3 02 d7 bf 60
    //              23 cd ce db 5e 01 25 eb bc 08 de e5 10 cb 23 64 14 92 15 10
    //              83 33 71 9a cd 97 cf a1 07 d4 02 24 ed c5 46 5a 93 2b 77 e7
    //              4e 80 2a 0d 42 bc 60 99 ad 23 00 00 00 80 00 6e f6 c1 ff 09
    //              00 00 00 00 00 00 10 c6 3a 94 9e 8b 79 55 39 4f fa 82 b8 e9
    //              42 c8 91 12 f4 ab 87 b1 bf ed a7 be 58 66 02 d9 85 43 0c ea
    //              01 62 ab 3f cf 45 91 c9 26 ab fb 07 67 19 23 02 00 00 00 b0
    //              ee a2 44 92 a6 60 58 3e ec b4 2c bc d3 de 3a 83 20 9d a1 7a
    //              0f af 60 fd 6a d9 b9 7a a5 fa 68 48 03 66 c9 c6 fd 6f a5 04
    //              3a a3 92 6b 81 e3 b5 9c 95 c2 5a 57 3d c2 ed 03 00 00 00 00
    //              00 00 00 af 99 43 14 12 fd 13 4a 99 63 82 a1 a0 4d 5b b9 24
    //              cf e5 f3 18 54 18 d6 05 ff ff 9c 4d 2e c7 c3 2f 20 95 e6 3c
    //              80 af f9 fa 74 0b 5b 76 32 f3 20 30 91 6f 89 c6 da d7 60 3f
    //              2b a2 a7 90 d6 2d 6f ae c2 fe d4 4d a4 92 8b 30 14 2b a1 1d
    //              e6 c5 d5 0b 83 ba e6 13 40 22 16 b5 05 4d 1e 7c 13 b1 35 5d
    //              6f 4a 82 45 ff a4 99 7d a9 c7 7a f4 c0 eb 97 fc a5 85 ec 6b
    //              f5 83 51 d5 64 be b6 d9 52 aa b9 c7 07 64 b0 a8 a7 58 3c 90
    //              b3 43 3b 80 9b db 9f bd 48 bc 87 34 95 cb ff 8a 32 6e ea 31
    //              ae 4e 0f 75 05 eb f6 c9 d1 33 30 ca 00 5a ce 1a 84 52 1f 14
    //              00 8c 9b 47 6f cc bd 6c 71 20 16 21 98 48 62 4b 87 ce c2 db
    //              e9 82 23 a0 eb 4f a3 9f 6b 5c 02 e6 d6 d9 07 56 ff 57 90 2a
    //              8f 57 00 00 00 00 97 00 cf 0b 4b 8b c2 29 41 33 00 00 00 00
    //              00 00 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 10
    //              00 8b c0 d9 55 97 11 e6 e8 86 1c 46 49 5b a5 85 a4 b2 d0 2e
    //              dc 3e 28 dd 27 1c 89 62 49 ed 85 b9 80 68 0b 00 00 2b 43 5a
    //              c1 5f c0 28 8d 9b 2a 16 9c dc ac c4 13 03 8d af b7 a2 c8 cb
    //              48 2b ac 0a c5 02 d9 ba 96 ff ff ff 7f 00 00 10 00 00 00 6d
    //              a2 1b 40 21 6e 14 ba 2d 6a d5 65 6b ff f1 7a dd ae da b2 5b
    //              30 00 2a bb ba 7f a7 25 f3 84 00 be 7c 1f 00 1b 2c d3 17 90
    //              2f 19 e3 85 be 9e 48 dc cf f7 29 43 32 82 83 06 89 da 6b 53
    //              b2 63 33 98 63 29 77 71 42 9d 12 00 00 00 33 41 bf 4a ba ca
    //              c9 59 00 fc a0 49 3c f2 9b 33 dc c9 ff ff ff ff ff ff ff d3
    //              9f ec 22 71 ff 01 58 96 46 ef d1 cf 87 0c d7 bb 23 66 fd e4
    //              1f 94 29 0c 2a 5f f8 70 ce 41 fd 34 67 de cb 05 cf d9 fc b3
    //              2c 8e d1 db d9 d1 0a 64 c1 08 3d 5e 71 b5 56 5b 17 68 ee 58
    //              96 9c 41 59 b3 64 a4 fd 70 13 f3 4d b1 73 a4 fd ac f1 52 29
    //              df 17 bc ad 70 fb 40 21 42 8c e9 70 27 5d 13 b7 81 00 78 8f
    //              11 f7 61 61 d4 6e a3 ab 60 fa 4d 30 dc 94 ef 24 18 75 f3 b4
    //              ce 02 32 fc ea 69 c2 71 d7 fa 29 82 2a ea 68 a6 60 e7 17 a0
    //              4b ec ff 0f 71 91 97 72 4f 4f ce 10 93 b6 2d 7e 8c 71 23 d8
    //              ec 57 1b e5 4c 72 d9 78 cf 90 6d f0 04 2e 36 ac d3 7d 7f 9e
    //              11 9f 2c 06 f8 15 31 2e 0c fe 22 2a 06 f5 6d d0 22 c0 74 eb
    //              8a 32 2f b0 bf 47 c0 a8 d1 54 b4 05 c3 7f ea f3 dd 95 f6 ef
    //              2a e5 82 78 61 05 c7 df 8b e5 87 70 50 c9 13 01 bb 99 73 16
    //              db f1 78 66 fb 84 d4 17 37 31 ef e8 95 ff 2e 1c 55 60 92 6e
    //              90 10 9b 59 85 02 d3 e9 59 ef c7 1f 66 5c 4d 75 cf 24 58 e3
    //              54 6c 1c 77 6d a6 4f b5 ab ee 0a cf d2 35 f2 f4 63 2c 90 62
    //              ec e8 4c 99 a0 61 88 7a 20 63 9b 41 c8 c1 2e e8 6c 50 80 40
    //              42 b3 fb 5a ac 51 8a 75 f9 e7 d7 10 1d 5e 18 6c 48 9b 3a 06
    //              fb 99 e0 aa 7f 23 a0 54 de 2f 4d 92 d6 bd 72 ee 2c 9f dc 75
    //              aa af 1e 3e 48 3b 4a d0 55 73 af 40 32 69 93 94 7d 9a 63 1b
    //              cb f3 58 37 84 ac bd a2 16 55 0d 7a ec 6b 79 e3 0c bd 12 8f
    //              54 c2 d3 33 54 57 ac f3 73 31 76 6e 47 23 91 e3 58 c3 b3 77
    //              32 7a c9 ec c3 4f 24 c9 ae 15 3e c6 0a c0 69 4d c5 5b ff 9f
    //              5f 45 f9 04 00 00 00 00 00 00 00 d6 b2 c5 ea 13 93 fd f2 42
    //              85 bf 16 b9 9c 9c c0 ad 18 57 21 6f 1a 98 5f 36 91 91 ae 95
    //              4f eb b3 df 46 4b fe 0f 7f 3e e9 af e7 be fb 89 d2 77 73 99
    //              f5 87 4c 55 3a eb 37 29 cf fe 86 e6 69 64 ae 09 bb 6d 16 31
    //              18 e4 cb e0 24 fd 45 00 f8 ff 07 00 00 00 00 cc 9d 80 46 c2
    //              16 c1 f8 95 77 8c b2 51 22 a2 a9 f9 b4 44 ae ad ea 2a 40 da
    //              8d ac cf 08 08 42 a4 86 72 17 37 39 0c bf 3a 74 cb 20 03 01
    //              6f 15 14 21 6b df 57 d2 a4 0d 40 b5 1a b6 3e 96 ec 84 85 b3
    //              b8 a8 c9 ae 3d 14 f9 31 00 c2 e0 89 38 62 ee f5 52 fc de 29
    //              81 f4 8c 48 2b de 8a 16 8c 3f 5d b2 fe a6 f2 6e 4a 43 04 e5
    //              0c 34 9f 4f 9e ce e2 7d ef c9 38 71 c5 f9 9b 35 5b 72 d5 38
    //              ba 49 78 ea 8e 4a a3 70 14 19 1e 10 09 6e 7e 60 fc 35 41 a2
    //              c9 05 a1 a9 5e 95 71 bf 38 ae 19 81 c4 23 8e ca ee 6f 75 cd
    //              0a 68 81 bd 15 17 a8 25 0d dc 86 74 15 2f 94 e3 a4 09 e2 a3
    //              bc e1 09 b6 00 00 00 00 00 00 00 00 d6 d5 21 0d 75 03 00 00
    //              00 a8 7a 27 60 2b 81 f7 63 86 f1 53 5b ef 14 97 f9 21 86 08
    //              6e 29 c6 bc 5a 1f ad 6e c9 a3 11 37 ab f9 a4 04 ab de 77 50
    //              89 8b 1b d6 27 e8 73 f8 70 3b e8 67 a2 8f 09 c5 87 7f c2 35
    //              5e cd c9 c3 0d cb 2d 70 d1 ab 57 07 52 28 a9 f4 6e d9 bd 1f
    //              08 fb 81 91 bb ab 2d c5 1d e3 a6 1f 08 68 af c4 29 48 59 32
    //              3e 6c 25 7a 45 31 9f 18 10 12 88 d1 39 bd 3d a2 0f ed 05 a8
    //              fe 64 68 0b 0a 3f c2 2d d7 04 00 00 00 00 94 69 12 d6 c9 8c
    //              d1 a9 fb e1 e7 d5 8c 08 ac af 30 23 5b 91 8a 31 d2 ec a5 5f
    //              74 a2 36 41 f6 1f 2d 5b 30 8c f0 d0 31 b0 00 95 56 23 7b ad
    //              f4 e7 96 5b be 27 77 e8 08 fc ba 82 1a a8 e8 c5 c3 96 09 ff
    //              85 43 52 cb 49 00 00 00 00 00 00 00 00 00 00 00 00 00 c1 fe
    //              e3 0a 3f 7a 85 d1 b2 9e 58 c7 76 85 ef c0 ce b1 c8 e5 72 9c
    //              66 41 8d 16 9f c0 3a a1 88 54 6b 3a d2 a1 82 06 8e 1e 3a 0e
    //              25 05 bc 7f 41 01 96 45 46 6a 53 f1 c9 6e 0d 4b 3b c1 9f aa
    //              54 49 20 9b 08 3d bd 33 4b 47 f0 67 bb ab 40 74 3b 2a 42 01
    //              00 82 00 8d f7 5c f4 3f 8e cc 8d 37 26 60 21 11 b4 0e 76 1f
    //              d2 10 81 92 03 82 f1 4d 12 ca 3c 34 31 ee 97 47 1c 78 68 dc
    //              da 7e aa 69 eb 7f 7f 80 57 2f dd 11 bb 1d 0d 12 80 fb c2 2b
    //              f7 34 68 78 8d f5 17 10 d7 d3 1c 63 2f c5 ed 17 62 eb 0b 42
    //              8e e7 51 c4 7d 8e 89 4f 74 5a 86 84 04 a0 bf 35 f0 12 10 08
    //              b7 22 b1 ea a6 ae df a1 bf 2e 7c cb 2d 61 d5 d7 22 6b bd 9c
    //              cd 62 8a b8 48 75 f2 c5 0b a8 91 ce a5 92 b0 43 0a 53 7a 39
    //              5d c7 3b da 36 7b f1 2c b7 d8 16 91 a5 fe 8c 47 be 39 56 56
    //              a2 97 e9 df 0e 71 f9 67 56 ea 5c ce 7d aa c4 be 29 01 59 f6
    //              bc d7 5f 0d da 9d e5 53 2e 71 ae 9e 48 b0 ed 02 54 a8 31 00
    //              00 00 00 f6 fb b8 69 60 4d 51 a3 6a 54 c8 32 e4 5b 25 69 dc
    //              0d 90 b0 75 22 5f de 44 c4 e0 97 31 71 ad 47 d6 b0 fd f9 74
    //              3a f9 32 cd 6d b4 9a 47 61 38 08 ba d9 59 71 03 00 00 00 00
    //              00 00 00 83 2d 0a 45 fa 42 42 e2 4c 7e 80 00 03 c9 e8 09 5e
    //              02 98 5f 28 e6 78 f6 64 22 43 6f 94 9e 2a b8 f1 62 d7 e3 f8
    //              55 e3 78 f4 a1 f4 0b 0c 6f b2 d4 b2 05 a8 00 b6 d7 13 ac eb
    //              c5 b0 14 e6 1a 54 3a 5a 19 4f 9a c1 8d 76 b5 44 0e 3b 1a 56
    //              9e 73 97 f6 ca fa 86 96 6d 7b a1 9e 72 04 13 26 7a 6c ce a9
    //              c4 39 67 1d 2c 68 0f 27 53 ca 18 4e ee b8 43 45 03 68 ac b4
    //              38 3a 01 d2 5e b3 d1 e2 3e 0f 26 45 d1 cd fa 9f a4 10 63 2f
    //              95 a5 f6 22 f8 51 c6 6e e7 e3 03 93 cd 7a 4d 67 ff 3a 49 c4
    //              f9 3c 09 84 b5 c2 d4 52 34 97 e4 d6 4f 95 f0 84 93 56 4a 1d
    //              f8 71 11 c9 bf 31 94 fe f9 7d ce cc 46 7a ce 45 fe eb 68 5c
    //              58 70 d0 5f 88 a0 f4 63 db 88 d3 77 44 2e 13 49 ac af 76 62
    //              18 b5 4a 9d 62 47 78 e1 c4 e0 64 c9 8e 49 41 98 27 6e b2 df
    //              77 66 41 1b ef 0e bb 50 00 00 00 00 00 60 65 d6 35 b0 b7 a0
    //              0e e7 67 22 1d 8a f9 75 33 87 e0 cd 8d 71 8f 54 a2 9d f6 eb
    //              a3 bd 4c 44 0e 6e 21 72 e3 fc c0 1b 8b ab b3 57 b5 c5 92 17
    //              b8 0d 0d b3 ba 58 28 14 a6 04 e4 ef 7a 80 3e 9c a7 c8 5b 35
    //              c9 b9 3a 9e 08 85 e2 38 b4 4a e1 c2 e6 4c ce 3b 27 08 3b 82
    //              46 82 9e 64 05 60 00 30 2b ff ff 15 40 5b d5 f2 eb a2 00 00
    //              00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9a 98 23 fd
    //              8f bc 5a a1 65 09 9c 5e d0 32 b4 8e a1 2d 8e 05 88 dc 52 70
    //              2e 40 84 91 3a 06 d4 68 d0 92 8b ad 76 d6 97 e1 f8 5a b0 30
    //              e7 88 d3 87 88 ee 5b 54 28 d4 a9 71 cc 97 db 9f d2 31 08 8e
    //              57 07 35 ce 12 9e 7e 77 fc 27 77 69 26 64 a1 48 8f d8 d6 df
    //              f4 da d6 18 fd 54 f5 29 d4 55 5c 65 07 00 9e e6 9d d1 bc 55
    //              25 87 89 b2 40 52 13 7e 96 37 f3 ef ba b7 17 20 f8 8c f5 73
    //              fe 0e 52 39 c0 00 be 27 33 c4 95 46 f6 e8 a9 17 5e c6 f1 4d
    //              bf 72 ca c9 16 43 b2 fd 99 c2 9e ca 28 a3 c2 e6 0d 5e 5b 87
    //              95 fa e1 6a 7c 3e a5 7e 72 8e ca 35 ea f0 15 5a 39 f9 75 80
    //              e0 79 17 54 26 c0 88 a0 20 80 40 98 2a 00 00 00 00 00 00 00
    //              00 00 00 00 00 00 51 ce aa f0 15 9f e6 1f 2e ad e7 60 3d 0a
    //              7a 56 fb 09 cd 11 9a c0 6a db 65 97 15 5a e4 78 46 89 2b b4
    //              23 c0 24 d8 cb e9 24 0b 71 ec 6d c2 12 4d 3a 19 e2 d7 14 b2
    //              73 d9 5d 1d 3a a7 37 cb 04 a3 36 15 ff 2a 73 0e 51 06 7d 5d
    //              67 5d 71 22 36 1c 37 c6 1a 43 b5 af d8 65 b6 0d 4c ae 89 1b
    //              73 22 0f 17 d2 59 85 a7 f7 68 34 99 5e 53 a9 3a 1c 7b 9e ef
    //              26 7d f6 91 ca 98 3a 0b 15 bd a7 f6 c5 c1 ca 7a a5 02 65 a3
    //              08 9a 1e bf 07 34 c9 b0 7e 89 51 ff 02 32 63 ad 5a ed 8c fb
    //              49 b4 9e 12 8c 69 77 24 c0 57 d2 2c 5d f5 ae f2 7c e3 db 11
    //              d5 ad 55 27 d1 49 d0 76 e1 a8 7e 2d f2 7c 0c b8 a6 7a d0 26
    //              bf 95 3e 88 f1 04 47 e1 25 c2 c0 f1 ae be e1 f3 39 0a 9e 3d
    //              da d4 e2 a6 e0 f6 e4 56 9f de fa 19 e8 70 e0 4a cf 94 93 b9
    //              63 f9 8e 23 cf c6 65 e4 f4 65 fa 3f 80 1e 19 57 c3 99 e4 5f
    //              61 d3 45 9b 1c 60 62 04 36 8b b9 31 34 5a f2 82 3c 48 7d 2f
    //              d9 9d b6 ea 6e 00 8e 7f fa 06 ca 86 15 51 18 9d 15 5b d0 77
    //              a7 9f e2 c7 e9 61 35 2e 56 82 4f 72 7d 21 d4 1e ae 78 bf ec
    //              4a 2d 7a 7e db c8 ef 95 8c 5e a5 99 f7 c2 5b f7 1c 23 40 55
    //              8a a1 2f dd 24 a8 8a aa d5 92 1a ee 7d ae 6a 2f 30 09 d9 cb
    //              43 ab 48 98 d0 f0 aa 56 54 31 b6 ab e5 85 d7 5d b0 4d 1c 9b
    //              a0 b9 de 4a e8 b0 d3 13 2b c6 81 0c c9 a6 93 97 9f 55 17 4a
    //              72 e1 df 9f de f3 5b c4 70 f9 e6 e5 91 98 27 57 f4 5c 52 c6
    //              45 d8 91 bf 63 bb 21 fb 66 92 6e be 1a 85 25 61 1f c3 e8 bb
    //              87 95 c3 6d c2 a8 6b 5a b4 6f f3 3c c7 4f 61 75 1b 2d ae 92
    //              67 6d b8 5c 8d 0c 72 1b 7e a4 54 4b f5 1c 95 c8 6f ca c1 f4
    //              34 d0 9d 1e e4 92 8a af e2 3d e6 6f ed 97 2e 0d dd fb 33 f6
    //              4e 48 70 1b 04 92 39 e7 f5 52 d8 16 44 1d 11 c4 c2 64 7c 01
    //              44 62 34 43 59 19 8d 97 c4 b6 e9 ed 31 ca 18 98 7b 64 de 07
    //              9b 2b ed 64 1e 8a 92 f1 3c a7 08 44 c6 5c b4 23 d0 19 50 b0
    //              eb f4 4b d2 8e 09 c0 5d 9a e5 dd 68 9f b8 80 fb 18 d0 42 21
    //              9f 5a c6 0c 3a 03 b0 85 ab f3 e8 e3 ef c8 42 a8 d3 28 73 34
    //              61 f0 4c 99 60 70 61 c6 5e d1 4c 61 32 2a 5a c2 d3 71 a9 5b
    //              8a d8 67 85 7e d1 3a 4f a4 ae 03 3a 09 67 38 66 cd 77 f4 bc
    //              da aa 05 20 71 66 b1 9a 87 58 d8 85 54 00 d8 c6 a7 24 2d c2
    //              07 25 1e 87 97 ec a2 4e a4 f4 87 66 3e 60 f2 f5 e1 f1 42 49
    //              58 fd 14 8f 84 68 30 e8 8a 42 d9 a0 e0 6d a2 00 48 1c de 8b
    //              f4 75 bc 3e 1f e9 c0 b4 a4 a2 68 92 17 38 93 8a a9 f3 cb 38
    //              11 ac 87 c5 4c 8e bc 8b cf b4 61 3c c3 a9 97 ff 15 79 ed bd
    //              4a de 80 20 e3 ad 00 1b 07 2b 1a 75 1b 58 8a c4 63 9f 35 a5
    //              8e 00 a5 0c 02 70 60 8c 7a 7f 10 13 2b 1c 25 b9 ea 81 23 2f
    //              be f6 65 f6 21 2f 87 5b 2a 00 00 00 00 00 00 00 00 00 00 00
    //              00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00} (length
    //              0xe06)
    //            }
    //          }
    //        }
    //        license: ptr[in, buffer] {
    //          buffer: {47 50 4c 00} (length 0x4)
    //        }
    //        loglev: int32 = 0x0 (4 bytes)
    //        logsize: len = 0x0 (4 bytes)
    //        log: nil
    //        kern_version: bpf_kern_version = 0x0 (4 bytes)
    //        flags: bpf_prog_load_flags = 0x0 (4 bytes)
    //        prog_name: buffer: {00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    //        00} (length 0x10) prog_ifindex: ifindex (resource)
    //        expected_attach_type: union bpf_prog_attach_types {
    //          fallback: bpf_attach_types = 0x0 (4 bytes)
    //        }
    //        btf_fd: fd_btf (resource)
    //        func_info_rec_size: const = 0x8 (4 bytes)
    //        func_info: ptr[in, bpf_func_info] {
    //          bpf_func_info {
    //            insn_off: int32 = 0x0 (4 bytes)
    //            type_id: int32 = 0x0 (4 bytes)
    //          }
    //        }
    //        func_info_cnt: len = 0x8 (4 bytes)
    //        line_info_rec_size: const = 0x10 (4 bytes)
    //        line_info: ptr[in, bpf_line_info] {
    //          bpf_line_info {
    //            insn_off: int32 = 0x0 (4 bytes)
    //            file_name_off: int32 = 0x0 (4 bytes)
    //            line_off: int32 = 0x0 (4 bytes)
    //            line_col: int32 = 0x0 (4 bytes)
    //          }
    //        }
    //        line_info_cnt: len = 0x10 (4 bytes)
    //        attach_btf_id: bpf_btf_id (resource)
    //        attach_prog_fd: fd_bpf_prog (resource)
    //        core_relo_cnt: len = 0x0 (4 bytes)
    //        fd_array: nil
    //        core_relos: nil
    //        core_relo_rec_size: const = 0x10 (4 bytes)
    //        log_true_size: int32 = 0x0 (4 bytes)
    //        prog_token_fd: union _bpf_prog_t[flags[bpf_prog_type, int32],
    //        bpf_prog_attach_types, bpf_btf_id[opt],
    //        fd_bpf_prog[opt]]_prog_token_fd_wrapper {
    //          void: buffer: {} (length 0x0)
    //        }
    //        pad: union _bpf_prog_t[flags[bpf_prog_type, int32],
    //        bpf_prog_attach_types, bpf_btf_id[opt],
    //        fd_bpf_prog[opt]]_pad_wrapper {
    //          value: const = 0x0 (4 bytes)
    //        }
    //      }
    //    }
    //    size: len = 0x2e (8 bytes)
    //  ]
    //  returns fd_bpf_prog
    NONFAILING(*(uint32_t*)0x200000000080 = 0x11);
    NONFAILING(*(uint32_t*)0x200000000084 = 8);
    NONFAILING(*(uint64_t*)0x200000000088 = 0x200000001c40);
    NONFAILING(memcpy(
        (void*)0x200000001c40,
        "\x62\x0a\xf8\xff\x0c\x20\x00\x21\xbf\xa1\x00\x00\x00\x00\x00\x00\x07"
        "\x01\x00\x00\xf8\xff\xff\xff\xb7\x02\x00\x00\x03\x00\x00\x00\xbd\x12"
        "\x00\x00\x00\x00\x00\x00\x85\x00\x00\x00\x06\x00\x00\x00\xb7\x00\x00"
        "\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x00\x00\x00\x3f\xaf\x4f\x1e"
        "\x7f\x2a\xa3\xd9\xb1\x8e\xd8\x1c\x0c\x86\x9b\x51\xec\x6c\x0a\xf4\xe0"
        "\xe4\xa9\x44\x6c\x76\x70\x56\x89\x82\xb4\xe0\x20\xf6\x98\x39\x3a\xa0"
        "\xf3\x88\x1f\x9c\x24\xaa\x56\xf1\x51\x99\xfa\xd0\x09\x3c\x59\xd6\x6b"
        "\x5e\xce\x9f\x36\xc7\x0d\x0f\x13\x90\x5e\xa2\x3c\x22\x62\x4c\x9f\x87"
        "\xf9\x79\x3f\x50\xbb\x54\x60\x40\x67\x7b\x0c\x50\x77\xda\x80\xfb\x98"
        "\x2c\x1e\x94\x00\xe6\x93\x14\x6c\xea\x48\x4a\x41\x5b\x76\x96\x61\x18"
        "\xb6\x4f\x75\x1a\x0f\x24\x1b\x07\x2e\x90\x08\x00\x08\x00\x2d\x75\x59"
        "\x3a\x28\x6c\xec\xc9\x3e\x64\xc2\x27\xc9\x5a\xa0\xb7\x84\x62\x57\x04"
        "\xf0\x7a\x72\xc2\x34\x66\x4c\x0a\xf9\x36\x0a\x1f\x7a\x5e\x6b\x60\x71"
        "\x30\xc8\x9f\x18\xc0\xc1\x08\x9d\x8b\x85\x32\x89\xe0\x1a\xa2\x7a\xe8"
        "\xb0\x9e\x00\xe7\x9a\xb2\x0b\x0b\x8e\x11\x48\xf4\x9f\xaf\x2a\xd0\x00"
        "\x00\x00\x00\x00\x00\x00\x6f\xa0\x3c\x64\x68\x97\x20\x89\xb3\x02\xd7"
        "\xbf\x60\x23\xcd\xce\xdb\x5e\x01\x25\xeb\xbc\x08\xde\xe5\x10\xcb\x23"
        "\x64\x14\x92\x15\x10\x83\x33\x71\x9a\xcd\x97\xcf\xa1\x07\xd4\x02\x24"
        "\xed\xc5\x46\x5a\x93\x2b\x77\xe7\x4e\x80\x2a\x0d\x42\xbc\x60\x99\xad"
        "\x23\x00\x00\x00\x80\x00\x6e\xf6\xc1\xff\x09\x00\x00\x00\x00\x00\x00"
        "\x10\xc6\x3a\x94\x9e\x8b\x79\x55\x39\x4f\xfa\x82\xb8\xe9\x42\xc8\x91"
        "\x12\xf4\xab\x87\xb1\xbf\xed\xa7\xbe\x58\x66\x02\xd9\x85\x43\x0c\xea"
        "\x01\x62\xab\x3f\xcf\x45\x91\xc9\x26\xab\xfb\x07\x67\x19\x23\x02\x00"
        "\x00\x00\xb0\xee\xa2\x44\x92\xa6\x60\x58\x3e\xec\xb4\x2c\xbc\xd3\xde"
        "\x3a\x83\x20\x9d\xa1\x7a\x0f\xaf\x60\xfd\x6a\xd9\xb9\x7a\xa5\xfa\x68"
        "\x48\x03\x66\xc9\xc6\xfd\x6f\xa5\x04\x3a\xa3\x92\x6b\x81\xe3\xb5\x9c"
        "\x95\xc2\x5a\x57\x3d\xc2\xed\x03\x00\x00\x00\x00\x00\x00\x00\xaf\x99"
        "\x43\x14\x12\xfd\x13\x4a\x99\x63\x82\xa1\xa0\x4d\x5b\xb9\x24\xcf\xe5"
        "\xf3\x18\x54\x18\xd6\x05\xff\xff\x9c\x4d\x2e\xc7\xc3\x2f\x20\x95\xe6"
        "\x3c\x80\xaf\xf9\xfa\x74\x0b\x5b\x76\x32\xf3\x20\x30\x91\x6f\x89\xc6"
        "\xda\xd7\x60\x3f\x2b\xa2\xa7\x90\xd6\x2d\x6f\xae\xc2\xfe\xd4\x4d\xa4"
        "\x92\x8b\x30\x14\x2b\xa1\x1d\xe6\xc5\xd5\x0b\x83\xba\xe6\x13\x40\x22"
        "\x16\xb5\x05\x4d\x1e\x7c\x13\xb1\x35\x5d\x6f\x4a\x82\x45\xff\xa4\x99"
        "\x7d\xa9\xc7\x7a\xf4\xc0\xeb\x97\xfc\xa5\x85\xec\x6b\xf5\x83\x51\xd5"
        "\x64\xbe\xb6\xd9\x52\xaa\xb9\xc7\x07\x64\xb0\xa8\xa7\x58\x3c\x90\xb3"
        "\x43\x3b\x80\x9b\xdb\x9f\xbd\x48\xbc\x87\x34\x95\xcb\xff\x8a\x32\x6e"
        "\xea\x31\xae\x4e\x0f\x75\x05\xeb\xf6\xc9\xd1\x33\x30\xca\x00\x5a\xce"
        "\x1a\x84\x52\x1f\x14\x00\x8c\x9b\x47\x6f\xcc\xbd\x6c\x71\x20\x16\x21"
        "\x98\x48\x62\x4b\x87\xce\xc2\xdb\xe9\x82\x23\xa0\xeb\x4f\xa3\x9f\x6b"
        "\x5c\x02\xe6\xd6\xd9\x07\x56\xff\x57\x90\x2a\x8f\x57\x00\x00\x00\x00"
        "\x97\x00\xcf\x0b\x4b\x8b\xc2\x29\x41\x33\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10"
        "\x00\x8b\xc0\xd9\x55\x97\x11\xe6\xe8\x86\x1c\x46\x49\x5b\xa5\x85\xa4"
        "\xb2\xd0\x2e\xdc\x3e\x28\xdd\x27\x1c\x89\x62\x49\xed\x85\xb9\x80\x68"
        "\x0b\x00\x00\x2b\x43\x5a\xc1\x5f\xc0\x28\x8d\x9b\x2a\x16\x9c\xdc\xac"
        "\xc4\x13\x03\x8d\xaf\xb7\xa2\xc8\xcb\x48\x2b\xac\x0a\xc5\x02\xd9\xba"
        "\x96\xff\xff\xff\x7f\x00\x00\x10\x00\x00\x00\x6d\xa2\x1b\x40\x21\x6e"
        "\x14\xba\x2d\x6a\xd5\x65\x6b\xff\xf1\x7a\xdd\xae\xda\xb2\x5b\x30\x00"
        "\x2a\xbb\xba\x7f\xa7\x25\xf3\x84\x00\xbe\x7c\x1f\x00\x1b\x2c\xd3\x17"
        "\x90\x2f\x19\xe3\x85\xbe\x9e\x48\xdc\xcf\xf7\x29\x43\x32\x82\x83\x06"
        "\x89\xda\x6b\x53\xb2\x63\x33\x98\x63\x29\x77\x71\x42\x9d\x12\x00\x00"
        "\x00\x33\x41\xbf\x4a\xba\xca\xc9\x59\x00\xfc\xa0\x49\x3c\xf2\x9b\x33"
        "\xdc\xc9\xff\xff\xff\xff\xff\xff\xff\xd3\x9f\xec\x22\x71\xff\x01\x58"
        "\x96\x46\xef\xd1\xcf\x87\x0c\xd7\xbb\x23\x66\xfd\xe4\x1f\x94\x29\x0c"
        "\x2a\x5f\xf8\x70\xce\x41\xfd\x34\x67\xde\xcb\x05\xcf\xd9\xfc\xb3\x2c"
        "\x8e\xd1\xdb\xd9\xd1\x0a\x64\xc1\x08\x3d\x5e\x71\xb5\x56\x5b\x17\x68"
        "\xee\x58\x96\x9c\x41\x59\xb3\x64\xa4\xfd\x70\x13\xf3\x4d\xb1\x73\xa4"
        "\xfd\xac\xf1\x52\x29\xdf\x17\xbc\xad\x70\xfb\x40\x21\x42\x8c\xe9\x70"
        "\x27\x5d\x13\xb7\x81\x00\x78\x8f\x11\xf7\x61\x61\xd4\x6e\xa3\xab\x60"
        "\xfa\x4d\x30\xdc\x94\xef\x24\x18\x75\xf3\xb4\xce\x02\x32\xfc\xea\x69"
        "\xc2\x71\xd7\xfa\x29\x82\x2a\xea\x68\xa6\x60\xe7\x17\xa0\x4b\xec\xff"
        "\x0f\x71\x91\x97\x72\x4f\x4f\xce\x10\x93\xb6\x2d\x7e\x8c\x71\x23\xd8"
        "\xec\x57\x1b\xe5\x4c\x72\xd9\x78\xcf\x90\x6d\xf0\x04\x2e\x36\xac\xd3"
        "\x7d\x7f\x9e\x11\x9f\x2c\x06\xf8\x15\x31\x2e\x0c\xfe\x22\x2a\x06\xf5"
        "\x6d\xd0\x22\xc0\x74\xeb\x8a\x32\x2f\xb0\xbf\x47\xc0\xa8\xd1\x54\xb4"
        "\x05\xc3\x7f\xea\xf3\xdd\x95\xf6\xef\x2a\xe5\x82\x78\x61\x05\xc7\xdf"
        "\x8b\xe5\x87\x70\x50\xc9\x13\x01\xbb\x99\x73\x16\xdb\xf1\x78\x66\xfb"
        "\x84\xd4\x17\x37\x31\xef\xe8\x95\xff\x2e\x1c\x55\x60\x92\x6e\x90\x10"
        "\x9b\x59\x85\x02\xd3\xe9\x59\xef\xc7\x1f\x66\x5c\x4d\x75\xcf\x24\x58"
        "\xe3\x54\x6c\x1c\x77\x6d\xa6\x4f\xb5\xab\xee\x0a\xcf\xd2\x35\xf2\xf4"
        "\x63\x2c\x90\x62\xec\xe8\x4c\x99\xa0\x61\x88\x7a\x20\x63\x9b\x41\xc8"
        "\xc1\x2e\xe8\x6c\x50\x80\x40\x42\xb3\xfb\x5a\xac\x51\x8a\x75\xf9\xe7"
        "\xd7\x10\x1d\x5e\x18\x6c\x48\x9b\x3a\x06\xfb\x99\xe0\xaa\x7f\x23\xa0"
        "\x54\xde\x2f\x4d\x92\xd6\xbd\x72\xee\x2c\x9f\xdc\x75\xaa\xaf\x1e\x3e"
        "\x48\x3b\x4a\xd0\x55\x73\xaf\x40\x32\x69\x93\x94\x7d\x9a\x63\x1b\xcb"
        "\xf3\x58\x37\x84\xac\xbd\xa2\x16\x55\x0d\x7a\xec\x6b\x79\xe3\x0c\xbd"
        "\x12\x8f\x54\xc2\xd3\x33\x54\x57\xac\xf3\x73\x31\x76\x6e\x47\x23\x91"
        "\xe3\x58\xc3\xb3\x77\x32\x7a\xc9\xec\xc3\x4f\x24\xc9\xae\x15\x3e\xc6"
        "\x0a\xc0\x69\x4d\xc5\x5b\xff\x9f\x5f\x45\xf9\x04\x00\x00\x00\x00\x00"
        "\x00\x00\xd6\xb2\xc5\xea\x13\x93\xfd\xf2\x42\x85\xbf\x16\xb9\x9c\x9c"
        "\xc0\xad\x18\x57\x21\x6f\x1a\x98\x5f\x36\x91\x91\xae\x95\x4f\xeb\xb3"
        "\xdf\x46\x4b\xfe\x0f\x7f\x3e\xe9\xaf\xe7\xbe\xfb\x89\xd2\x77\x73\x99"
        "\xf5\x87\x4c\x55\x3a\xeb\x37\x29\xcf\xfe\x86\xe6\x69\x64\xae\x09\xbb"
        "\x6d\x16\x31\x18\xe4\xcb\xe0\x24\xfd\x45\x00\xf8\xff\x07\x00\x00\x00"
        "\x00\xcc\x9d\x80\x46\xc2\x16\xc1\xf8\x95\x77\x8c\xb2\x51\x22\xa2\xa9"
        "\xf9\xb4\x44\xae\xad\xea\x2a\x40\xda\x8d\xac\xcf\x08\x08\x42\xa4\x86"
        "\x72\x17\x37\x39\x0c\xbf\x3a\x74\xcb\x20\x03\x01\x6f\x15\x14\x21\x6b"
        "\xdf\x57\xd2\xa4\x0d\x40\xb5\x1a\xb6\x3e\x96\xec\x84\x85\xb3\xb8\xa8"
        "\xc9\xae\x3d\x14\xf9\x31\x00\xc2\xe0\x89\x38\x62\xee\xf5\x52\xfc\xde"
        "\x29\x81\xf4\x8c\x48\x2b\xde\x8a\x16\x8c\x3f\x5d\xb2\xfe\xa6\xf2\x6e"
        "\x4a\x43\x04\xe5\x0c\x34\x9f\x4f\x9e\xce\xe2\x7d\xef\xc9\x38\x71\xc5"
        "\xf9\x9b\x35\x5b\x72\xd5\x38\xba\x49\x78\xea\x8e\x4a\xa3\x70\x14\x19"
        "\x1e\x10\x09\x6e\x7e\x60\xfc\x35\x41\xa2\xc9\x05\xa1\xa9\x5e\x95\x71"
        "\xbf\x38\xae\x19\x81\xc4\x23\x8e\xca\xee\x6f\x75\xcd\x0a\x68\x81\xbd"
        "\x15\x17\xa8\x25\x0d\xdc\x86\x74\x15\x2f\x94\xe3\xa4\x09\xe2\xa3\xbc"
        "\xe1\x09\xb6\x00\x00\x00\x00\x00\x00\x00\x00\xd6\xd5\x21\x0d\x75\x03"
        "\x00\x00\x00\xa8\x7a\x27\x60\x2b\x81\xf7\x63\x86\xf1\x53\x5b\xef\x14"
        "\x97\xf9\x21\x86\x08\x6e\x29\xc6\xbc\x5a\x1f\xad\x6e\xc9\xa3\x11\x37"
        "\xab\xf9\xa4\x04\xab\xde\x77\x50\x89\x8b\x1b\xd6\x27\xe8\x73\xf8\x70"
        "\x3b\xe8\x67\xa2\x8f\x09\xc5\x87\x7f\xc2\x35\x5e\xcd\xc9\xc3\x0d\xcb"
        "\x2d\x70\xd1\xab\x57\x07\x52\x28\xa9\xf4\x6e\xd9\xbd\x1f\x08\xfb\x81"
        "\x91\xbb\xab\x2d\xc5\x1d\xe3\xa6\x1f\x08\x68\xaf\xc4\x29\x48\x59\x32"
        "\x3e\x6c\x25\x7a\x45\x31\x9f\x18\x10\x12\x88\xd1\x39\xbd\x3d\xa2\x0f"
        "\xed\x05\xa8\xfe\x64\x68\x0b\x0a\x3f\xc2\x2d\xd7\x04\x00\x00\x00\x00"
        "\x94\x69\x12\xd6\xc9\x8c\xd1\xa9\xfb\xe1\xe7\xd5\x8c\x08\xac\xaf\x30"
        "\x23\x5b\x91\x8a\x31\xd2\xec\xa5\x5f\x74\xa2\x36\x41\xf6\x1f\x2d\x5b"
        "\x30\x8c\xf0\xd0\x31\xb0\x00\x95\x56\x23\x7b\xad\xf4\xe7\x96\x5b\xbe"
        "\x27\x77\xe8\x08\xfc\xba\x82\x1a\xa8\xe8\xc5\xc3\x96\x09\xff\x85\x43"
        "\x52\xcb\x49\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1"
        "\xfe\xe3\x0a\x3f\x7a\x85\xd1\xb2\x9e\x58\xc7\x76\x85\xef\xc0\xce\xb1"
        "\xc8\xe5\x72\x9c\x66\x41\x8d\x16\x9f\xc0\x3a\xa1\x88\x54\x6b\x3a\xd2"
        "\xa1\x82\x06\x8e\x1e\x3a\x0e\x25\x05\xbc\x7f\x41\x01\x96\x45\x46\x6a"
        "\x53\xf1\xc9\x6e\x0d\x4b\x3b\xc1\x9f\xaa\x54\x49\x20\x9b\x08\x3d\xbd"
        "\x33\x4b\x47\xf0\x67\xbb\xab\x40\x74\x3b\x2a\x42\x01\x00\x82\x00\x8d"
        "\xf7\x5c\xf4\x3f\x8e\xcc\x8d\x37\x26\x60\x21\x11\xb4\x0e\x76\x1f\xd2"
        "\x10\x81\x92\x03\x82\xf1\x4d\x12\xca\x3c\x34\x31\xee\x97\x47\x1c\x78"
        "\x68\xdc\xda\x7e\xaa\x69\xeb\x7f\x7f\x80\x57\x2f\xdd\x11\xbb\x1d\x0d"
        "\x12\x80\xfb\xc2\x2b\xf7\x34\x68\x78\x8d\xf5\x17\x10\xd7\xd3\x1c\x63"
        "\x2f\xc5\xed\x17\x62\xeb\x0b\x42\x8e\xe7\x51\xc4\x7d\x8e\x89\x4f\x74"
        "\x5a\x86\x84\x04\xa0\xbf\x35\xf0\x12\x10\x08\xb7\x22\xb1\xea\xa6\xae"
        "\xdf\xa1\xbf\x2e\x7c\xcb\x2d\x61\xd5\xd7\x22\x6b\xbd\x9c\xcd\x62\x8a"
        "\xb8\x48\x75\xf2\xc5\x0b\xa8\x91\xce\xa5\x92\xb0\x43\x0a\x53\x7a\x39"
        "\x5d\xc7\x3b\xda\x36\x7b\xf1\x2c\xb7\xd8\x16\x91\xa5\xfe\x8c\x47\xbe"
        "\x39\x56\x56\xa2\x97\xe9\xdf\x0e\x71\xf9\x67\x56\xea\x5c\xce\x7d\xaa"
        "\xc4\xbe\x29\x01\x59\xf6\xbc\xd7\x5f\x0d\xda\x9d\xe5\x53\x2e\x71\xae"
        "\x9e\x48\xb0\xed\x02\x54\xa8\x31\x00\x00\x00\x00\xf6\xfb\xb8\x69\x60"
        "\x4d\x51\xa3\x6a\x54\xc8\x32\xe4\x5b\x25\x69\xdc\x0d\x90\xb0\x75\x22"
        "\x5f\xde\x44\xc4\xe0\x97\x31\x71\xad\x47\xd6\xb0\xfd\xf9\x74\x3a\xf9"
        "\x32\xcd\x6d\xb4\x9a\x47\x61\x38\x08\xba\xd9\x59\x71\x03\x00\x00\x00"
        "\x00\x00\x00\x00\x83\x2d\x0a\x45\xfa\x42\x42\xe2\x4c\x7e\x80\x00\x03"
        "\xc9\xe8\x09\x5e\x02\x98\x5f\x28\xe6\x78\xf6\x64\x22\x43\x6f\x94\x9e"
        "\x2a\xb8\xf1\x62\xd7\xe3\xf8\x55\xe3\x78\xf4\xa1\xf4\x0b\x0c\x6f\xb2"
        "\xd4\xb2\x05\xa8\x00\xb6\xd7\x13\xac\xeb\xc5\xb0\x14\xe6\x1a\x54\x3a"
        "\x5a\x19\x4f\x9a\xc1\x8d\x76\xb5\x44\x0e\x3b\x1a\x56\x9e\x73\x97\xf6"
        "\xca\xfa\x86\x96\x6d\x7b\xa1\x9e\x72\x04\x13\x26\x7a\x6c\xce\xa9\xc4"
        "\x39\x67\x1d\x2c\x68\x0f\x27\x53\xca\x18\x4e\xee\xb8\x43\x45\x03\x68"
        "\xac\xb4\x38\x3a\x01\xd2\x5e\xb3\xd1\xe2\x3e\x0f\x26\x45\xd1\xcd\xfa"
        "\x9f\xa4\x10\x63\x2f\x95\xa5\xf6\x22\xf8\x51\xc6\x6e\xe7\xe3\x03\x93"
        "\xcd\x7a\x4d\x67\xff\x3a\x49\xc4\xf9\x3c\x09\x84\xb5\xc2\xd4\x52\x34"
        "\x97\xe4\xd6\x4f\x95\xf0\x84\x93\x56\x4a\x1d\xf8\x71\x11\xc9\xbf\x31"
        "\x94\xfe\xf9\x7d\xce\xcc\x46\x7a\xce\x45\xfe\xeb\x68\x5c\x58\x70\xd0"
        "\x5f\x88\xa0\xf4\x63\xdb\x88\xd3\x77\x44\x2e\x13\x49\xac\xaf\x76\x62"
        "\x18\xb5\x4a\x9d\x62\x47\x78\xe1\xc4\xe0\x64\xc9\x8e\x49\x41\x98\x27"
        "\x6e\xb2\xdf\x77\x66\x41\x1b\xef\x0e\xbb\x50\x00\x00\x00\x00\x00\x60"
        "\x65\xd6\x35\xb0\xb7\xa0\x0e\xe7\x67\x22\x1d\x8a\xf9\x75\x33\x87\xe0"
        "\xcd\x8d\x71\x8f\x54\xa2\x9d\xf6\xeb\xa3\xbd\x4c\x44\x0e\x6e\x21\x72"
        "\xe3\xfc\xc0\x1b\x8b\xab\xb3\x57\xb5\xc5\x92\x17\xb8\x0d\x0d\xb3\xba"
        "\x58\x28\x14\xa6\x04\xe4\xef\x7a\x80\x3e\x9c\xa7\xc8\x5b\x35\xc9\xb9"
        "\x3a\x9e\x08\x85\xe2\x38\xb4\x4a\xe1\xc2\xe6\x4c\xce\x3b\x27\x08\x3b"
        "\x82\x46\x82\x9e\x64\x05\x60\x00\x30\x2b\xff\xff\x15\x40\x5b\xd5\xf2"
        "\xeb\xa2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x9a\x98\x23\xfd\x8f\xbc\x5a\xa1\x65\x09\x9c\x5e\xd0\x32"
        "\xb4\x8e\xa1\x2d\x8e\x05\x88\xdc\x52\x70\x2e\x40\x84\x91\x3a\x06\xd4"
        "\x68\xd0\x92\x8b\xad\x76\xd6\x97\xe1\xf8\x5a\xb0\x30\xe7\x88\xd3\x87"
        "\x88\xee\x5b\x54\x28\xd4\xa9\x71\xcc\x97\xdb\x9f\xd2\x31\x08\x8e\x57"
        "\x07\x35\xce\x12\x9e\x7e\x77\xfc\x27\x77\x69\x26\x64\xa1\x48\x8f\xd8"
        "\xd6\xdf\xf4\xda\xd6\x18\xfd\x54\xf5\x29\xd4\x55\x5c\x65\x07\x00\x9e"
        "\xe6\x9d\xd1\xbc\x55\x25\x87\x89\xb2\x40\x52\x13\x7e\x96\x37\xf3\xef"
        "\xba\xb7\x17\x20\xf8\x8c\xf5\x73\xfe\x0e\x52\x39\xc0\x00\xbe\x27\x33"
        "\xc4\x95\x46\xf6\xe8\xa9\x17\x5e\xc6\xf1\x4d\xbf\x72\xca\xc9\x16\x43"
        "\xb2\xfd\x99\xc2\x9e\xca\x28\xa3\xc2\xe6\x0d\x5e\x5b\x87\x95\xfa\xe1"
        "\x6a\x7c\x3e\xa5\x7e\x72\x8e\xca\x35\xea\xf0\x15\x5a\x39\xf9\x75\x80"
        "\xe0\x79\x17\x54\x26\xc0\x88\xa0\x20\x80\x40\x98\x2a\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x51\xce\xaa\xf0\x15\x9f\xe6\x1f"
        "\x2e\xad\xe7\x60\x3d\x0a\x7a\x56\xfb\x09\xcd\x11\x9a\xc0\x6a\xdb\x65"
        "\x97\x15\x5a\xe4\x78\x46\x89\x2b\xb4\x23\xc0\x24\xd8\xcb\xe9\x24\x0b"
        "\x71\xec\x6d\xc2\x12\x4d\x3a\x19\xe2\xd7\x14\xb2\x73\xd9\x5d\x1d\x3a"
        "\xa7\x37\xcb\x04\xa3\x36\x15\xff\x2a\x73\x0e\x51\x06\x7d\x5d\x67\x5d"
        "\x71\x22\x36\x1c\x37\xc6\x1a\x43\xb5\xaf\xd8\x65\xb6\x0d\x4c\xae\x89"
        "\x1b\x73\x22\x0f\x17\xd2\x59\x85\xa7\xf7\x68\x34\x99\x5e\x53\xa9\x3a"
        "\x1c\x7b\x9e\xef\x26\x7d\xf6\x91\xca\x98\x3a\x0b\x15\xbd\xa7\xf6\xc5"
        "\xc1\xca\x7a\xa5\x02\x65\xa3\x08\x9a\x1e\xbf\x07\x34\xc9\xb0\x7e\x89"
        "\x51\xff\x02\x32\x63\xad\x5a\xed\x8c\xfb\x49\xb4\x9e\x12\x8c\x69\x77"
        "\x24\xc0\x57\xd2\x2c\x5d\xf5\xae\xf2\x7c\xe3\xdb\x11\xd5\xad\x55\x27"
        "\xd1\x49\xd0\x76\xe1\xa8\x7e\x2d\xf2\x7c\x0c\xb8\xa6\x7a\xd0\x26\xbf"
        "\x95\x3e\x88\xf1\x04\x47\xe1\x25\xc2\xc0\xf1\xae\xbe\xe1\xf3\x39\x0a"
        "\x9e\x3d\xda\xd4\xe2\xa6\xe0\xf6\xe4\x56\x9f\xde\xfa\x19\xe8\x70\xe0"
        "\x4a\xcf\x94\x93\xb9\x63\xf9\x8e\x23\xcf\xc6\x65\xe4\xf4\x65\xfa\x3f"
        "\x80\x1e\x19\x57\xc3\x99\xe4\x5f\x61\xd3\x45\x9b\x1c\x60\x62\x04\x36"
        "\x8b\xb9\x31\x34\x5a\xf2\x82\x3c\x48\x7d\x2f\xd9\x9d\xb6\xea\x6e\x00"
        "\x8e\x7f\xfa\x06\xca\x86\x15\x51\x18\x9d\x15\x5b\xd0\x77\xa7\x9f\xe2"
        "\xc7\xe9\x61\x35\x2e\x56\x82\x4f\x72\x7d\x21\xd4\x1e\xae\x78\xbf\xec"
        "\x4a\x2d\x7a\x7e\xdb\xc8\xef\x95\x8c\x5e\xa5\x99\xf7\xc2\x5b\xf7\x1c"
        "\x23\x40\x55\x8a\xa1\x2f\xdd\x24\xa8\x8a\xaa\xd5\x92\x1a\xee\x7d\xae"
        "\x6a\x2f\x30\x09\xd9\xcb\x43\xab\x48\x98\xd0\xf0\xaa\x56\x54\x31\xb6"
        "\xab\xe5\x85\xd7\x5d\xb0\x4d\x1c\x9b\xa0\xb9\xde\x4a\xe8\xb0\xd3\x13"
        "\x2b\xc6\x81\x0c\xc9\xa6\x93\x97\x9f\x55\x17\x4a\x72\xe1\xdf\x9f\xde"
        "\xf3\x5b\xc4\x70\xf9\xe6\xe5\x91\x98\x27\x57\xf4\x5c\x52\xc6\x45\xd8"
        "\x91\xbf\x63\xbb\x21\xfb\x66\x92\x6e\xbe\x1a\x85\x25\x61\x1f\xc3\xe8"
        "\xbb\x87\x95\xc3\x6d\xc2\xa8\x6b\x5a\xb4\x6f\xf3\x3c\xc7\x4f\x61\x75"
        "\x1b\x2d\xae\x92\x67\x6d\xb8\x5c\x8d\x0c\x72\x1b\x7e\xa4\x54\x4b\xf5"
        "\x1c\x95\xc8\x6f\xca\xc1\xf4\x34\xd0\x9d\x1e\xe4\x92\x8a\xaf\xe2\x3d"
        "\xe6\x6f\xed\x97\x2e\x0d\xdd\xfb\x33\xf6\x4e\x48\x70\x1b\x04\x92\x39"
        "\xe7\xf5\x52\xd8\x16\x44\x1d\x11\xc4\xc2\x64\x7c\x01\x44\x62\x34\x43"
        "\x59\x19\x8d\x97\xc4\xb6\xe9\xed\x31\xca\x18\x98\x7b\x64\xde\x07\x9b"
        "\x2b\xed\x64\x1e\x8a\x92\xf1\x3c\xa7\x08\x44\xc6\x5c\xb4\x23\xd0\x19"
        "\x50\xb0\xeb\xf4\x4b\xd2\x8e\x09\xc0\x5d\x9a\xe5\xdd\x68\x9f\xb8\x80"
        "\xfb\x18\xd0\x42\x21\x9f\x5a\xc6\x0c\x3a\x03\xb0\x85\xab\xf3\xe8\xe3"
        "\xef\xc8\x42\xa8\xd3\x28\x73\x34\x61\xf0\x4c\x99\x60\x70\x61\xc6\x5e"
        "\xd1\x4c\x61\x32\x2a\x5a\xc2\xd3\x71\xa9\x5b\x8a\xd8\x67\x85\x7e\xd1"
        "\x3a\x4f\xa4\xae\x03\x3a\x09\x67\x38\x66\xcd\x77\xf4\xbc\xda\xaa\x05"
        "\x20\x71\x66\xb1\x9a\x87\x58\xd8\x85\x54\x00\xd8\xc6\xa7\x24\x2d\xc2"
        "\x07\x25\x1e\x87\x97\xec\xa2\x4e\xa4\xf4\x87\x66\x3e\x60\xf2\xf5\xe1"
        "\xf1\x42\x49\x58\xfd\x14\x8f\x84\x68\x30\xe8\x8a\x42\xd9\xa0\xe0\x6d"
        "\xa2\x00\x48\x1c\xde\x8b\xf4\x75\xbc\x3e\x1f\xe9\xc0\xb4\xa4\xa2\x68"
        "\x92\x17\x38\x93\x8a\xa9\xf3\xcb\x38\x11\xac\x87\xc5\x4c\x8e\xbc\x8b"
        "\xcf\xb4\x61\x3c\xc3\xa9\x97\xff\x15\x79\xed\xbd\x4a\xde\x80\x20\xe3"
        "\xad\x00\x1b\x07\x2b\x1a\x75\x1b\x58\x8a\xc4\x63\x9f\x35\xa5\x8e\x00"
        "\xa5\x0c\x02\x70\x60\x8c\x7a\x7f\x10\x13\x2b\x1c\x25\xb9\xea\x81\x23"
        "\x2f\xbe\xf6\x65\xf6\x21\x2f\x87\x5b\x2a\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00",
        3590));
    NONFAILING(*(uint64_t*)0x200000000090 = 0x200000000380);
    NONFAILING(memcpy((void*)0x200000000380, "GPL\000", 4));
    NONFAILING(*(uint32_t*)0x200000000098 = 0);
    NONFAILING(*(uint32_t*)0x20000000009c = 0);
    NONFAILING(*(uint64_t*)0x2000000000a0 = 0);
    NONFAILING(*(uint32_t*)0x2000000000a8 = 0);
    NONFAILING(*(uint32_t*)0x2000000000ac = 0);
    NONFAILING(memset((void*)0x2000000000b0, 0, 16));
    NONFAILING(*(uint32_t*)0x2000000000c0 = 0);
    NONFAILING(*(uint32_t*)0x2000000000c4 = 0);
    NONFAILING(*(uint32_t*)0x2000000000c8 = -1);
    NONFAILING(*(uint32_t*)0x2000000000cc = 8);
    NONFAILING(*(uint64_t*)0x2000000000d0 = 0x200000000000);
    NONFAILING(*(uint32_t*)0x200000000000 = 0);
    NONFAILING(*(uint32_t*)0x200000000004 = 0);
    NONFAILING(*(uint32_t*)0x2000000000d8 = 8);
    NONFAILING(*(uint32_t*)0x2000000000dc = 0x10);
    NONFAILING(*(uint64_t*)0x2000000000e0 = 0x200000000000);
    NONFAILING(*(uint32_t*)0x200000000000 = 0);
    NONFAILING(*(uint32_t*)0x200000000004 = 0);
    NONFAILING(*(uint32_t*)0x200000000008 = 0);
    NONFAILING(*(uint32_t*)0x20000000000c = 0);
    NONFAILING(*(uint32_t*)0x2000000000e8 = 0x10);
    NONFAILING(*(uint32_t*)0x2000000000ec = 0);
    NONFAILING(*(uint32_t*)0x2000000000f0 = -1);
    NONFAILING(*(uint32_t*)0x2000000000f4 = 0);
    NONFAILING(*(uint64_t*)0x2000000000f8 = 0);
    NONFAILING(*(uint64_t*)0x200000000100 = 0);
    NONFAILING(*(uint32_t*)0x200000000108 = 0x10);
    NONFAILING(*(uint32_t*)0x20000000010c = 0);
    NONFAILING(*(uint32_t*)0x200000000110 = 0);
    res = syscall(__NR_bpf, /*cmd=*/5ul, /*arg=*/0x200000000080ul,
                  /*size=*/0x2eul);
    if (res != -1)
      r[1] = res;
    break;
  case 4:
    //  bpf$BPF_RAW_TRACEPOINT_OPEN arguments: [
    //    cmd: const = 0x11 (8 bytes)
    //    arg: ptr[in, bpf_raw_tracepoint] {
    //      bpf_raw_tracepoint {
    //        name: ptr[in, buffer] {
    //          buffer: {72 63 75 5f 75 74 69 6c 69 7a 61 74 69 6f 6e 00}
    //          (length 0x10)
    //        }
    //        prog_fd: fd_bpf_prog_raw_tracepoint (resource)
    //        pad: const = 0x0 (4 bytes)
    //        cookie: int64 = 0x0 (8 bytes)
    //      }
    //    }
    //    size: len = 0x10 (8 bytes)
    //  ]
    //  returns fd_perf_base
    NONFAILING(*(uint64_t*)0x200000000180 = 0x200000000540);
    NONFAILING(memcpy((void*)0x200000000540, "rcu_utilization\000", 16));
    NONFAILING(*(uint32_t*)0x200000000188 = r[1]);
    NONFAILING(*(uint32_t*)0x20000000018c = 0);
    NONFAILING(*(uint64_t*)0x200000000190 = 0);
    syscall(__NR_bpf, /*cmd=*/0x11ul, /*arg=*/0x200000000180ul,
            /*size=*/0x10ul);
    for (int i = 0; i < 64; i++) {
      syscall(__NR_bpf, /*cmd=*/0x11ul, /*arg=*/0x200000000180ul,
              /*size=*/0x10ul);
    }
    break;
  case 5:
    //  bpf$BPF_RAW_TRACEPOINT_OPEN arguments: [
    //    cmd: const = 0x11 (8 bytes)
    //    arg: nil
    //    size: len = 0x0 (8 bytes)
    //  ]
    //  returns fd_perf_base
    syscall(__NR_bpf, /*cmd=*/0x11ul, /*arg=*/0ul, /*size=*/0ul);
    break;
  case 6:
    //  setpriority arguments: [
    //    which: priority_which = 0x0 (8 bytes)
    //    who: pid (resource)
    //    prio: intptr = 0xacf0165 (8 bytes)
    //  ]
    syscall(__NR_setpriority, /*which=*/0ul, /*who=*/0, /*prio=*/0xacf0165ul);
    for (int i = 0; i < 32; i++) {
      syscall(__NR_setpriority, /*which=*/0ul, /*who=*/0, /*prio=*/0xacf0165ul);
    }
    break;
  case 7:
    //  pipe2$watch_queue arguments: [
    //    pipefd: nil
    //    flags: const = 0x80 (8 bytes)
    //  ]
    syscall(__NR_pipe2, /*pipefd=*/0ul, /*flags=*/0x80ul);
    break;
  case 8:
    //  add_key$user arguments: [
    //    type: ptr[in, buffer] {
    //      buffer: {75 73 65 72 00} (length 0x5)
    //    }
    //    desc: nil
    //    payload: ptr[in, buffer] {
    //      buffer: {0c db d6 08 58 6d 0e e7 ff cf b8 e8 b8 54 e0 65 80 c3 5c 33
    //      b9 0c 4b 56 7b bd e7 5b 3b 00 be 60 35 d4 d0 c6 79 97 14 f4 4c ac 6c
    //      b9 97 52 de a7 b9 29 bd cf 48 52} (length 0x36)
    //    }
    //    paylen: len = 0x36 (8 bytes)
    //    keyring: keyring (resource)
    //  ]
    //  returns user_key
    NONFAILING(memcpy((void*)0x2000000000c0, "user\000", 5));
    NONFAILING(memcpy((void*)0x2000000001c0,
                      "\x0c\xdb\xd6\x08\x58\x6d\x0e\xe7\xff\xcf\xb8\xe8\xb8\x54"
                      "\xe0\x65\x80\xc3\x5c\x33\xb9\x0c\x4b\x56\x7b\xbd\xe7\x5b"
                      "\x3b\x00\xbe\x60\x35\xd4\xd0\xc6\x79\x97\x14\xf4\x4c\xac"
                      "\x6c\xb9\x97\x52\xde\xa7\xb9\x29\xbd\xcf\x48\x52",
                      54));
    syscall(__NR_add_key, /*type=*/0x2000000000c0ul, /*desc=*/0ul,
            /*payload=*/0x2000000001c0ul, /*paylen=*/0x36ul, /*keyring=*/r[0]);
    break;
  case 9:
    //  syz_open_dev$video arguments: [
    //    dev: ptr[in, buffer] {
    //      buffer: {2f 64 65 76 2f 76 69 64 65 6f 23 00} (length 0xc)
    //    }
    //    id: intptr = 0x8 (8 bytes)
    //    flags: open_flags = 0x0 (8 bytes)
    //  ]
    //  returns fd_video
    NONFAILING(memcpy((void*)0x200000000000, "/dev/video#\000", 12));
    NONFAILING(syz_open_dev(/*dev=*/0x200000000000, /*id=*/8, /*flags=*/0));
    break;
  case 10:
    //  openat arguments: [
    //    fd: fd_dir (resource)
    //    file: ptr[in, buffer] {
    //      buffer: {2e 2f 66 69 6c 65 31 00} (length 0x8)
    //    }
    //    flags: open_flags = 0x6840 (4 bytes)
    //    mode: open_mode = 0x0 (2 bytes)
    //  ]
    //  returns fd
    NONFAILING(memcpy((void*)0x200000000100, "./file1\000", 8));
    syscall(__NR_openat, /*fd=*/0xffffff9c, /*file=*/0x200000000100ul,
            /*flags=O_NONBLOCK|O_DIRECT|O_CREAT|FASYNC*/ 0x6840, /*mode=*/0);
    break;
  case 11:
    //  syz_open_dev$audion arguments: [
    //    dev: ptr[in, buffer] {
    //      buffer: {2f 64 65 76 2f 61 75 64 69 6f 23 00} (length 0xc)
    //    }
    //    id: intptr = 0x1ff (8 bytes)
    //    flags: open_flags = 0x0 (8 bytes)
    //  ]
    //  returns fd
    NONFAILING(memcpy((void*)0x200000000040, "/dev/audio#\000", 12));
    NONFAILING(syz_open_dev(/*dev=*/0x200000000040, /*id=*/0x1ff, /*flags=*/0));
    break;
  case 12:
    //  syz_open_dev$sndctrl arguments: [
    //    dev: ptr[in, buffer] {
    //      buffer: {2f 64 65 76 2f 73 6e 64 2f 63 6f 6e 74 72 6f 6c 43 23 00}
    //      (length 0x13)
    //    }
    //    id: intptr = 0x80000000 (8 bytes)
    //    flags: open_flags = 0x0 (8 bytes)
    //  ]
    //  returns fd_sndctrl
    NONFAILING(memcpy((void*)0x200000000040, "/dev/snd/controlC#\000", 19));
    NONFAILING(
        syz_open_dev(/*dev=*/0x200000000040, /*id=*/0x80000000, /*flags=*/0));
    break;
  case 13:
    //  openat arguments: [
    //    fd: fd_dir (resource)
    //    file: nil
    //    flags: open_flags = 0x0 (4 bytes)
    //    mode: open_mode = 0x1cf (2 bytes)
    //  ]
    //  returns fd
    syscall(
        __NR_openat, /*fd=*/0xffffff9c, /*file=*/0ul, /*flags=*/0,
        /*mode=S_IXOTH|S_IWOTH|S_IROTH|S_IXGRP|S_IXUSR|S_IWUSR|S_IRUSR*/ 0x1cf);
    break;
  case 14:
    //  openat$qrtrtun arguments: [
    //    fd: const = 0xffffffffffffff9c (8 bytes)
    //    file: nil
    //    flags: open_flags = 0x0 (4 bytes)
    //  ]
    //  returns fd_qrtr_tun
    syscall(__NR_openat, /*fd=*/0xffffffffffffff9cul, /*file=*/0ul, /*flags=*/0,
            0);
    break;
  case 15:
    //  bpf$BPF_BTF_LOAD arguments: [
    //    cmd: const = 0x12 (8 bytes)
    //    arg: nil
    //    size: len = 0x0 (8 bytes)
    //  ]
    //  returns fd_btf
    syscall(__NR_bpf, /*cmd=*/0x12ul, /*arg=*/0ul, /*size=*/0ul);
    break;
  }
}
int main(void)
{
  syscall(__NR_mmap, /*addr=*/0x1ffffffff000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200000000000ul, /*len=*/0x1000000ul,
          /*prot=PROT_WRITE|PROT_READ|PROT_EXEC*/ 7ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200001000000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  setup_sysctl();
  const char* reason;
  (void)reason;
  install_segv_handler();
  for (procid = 0; procid < 5; procid++) {
    if (fork() == 0) {
      loop();
    }
  }
  sleep(1000000);
  return 0;
}
